(async()=>{for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise((e=>setTimeout(e,10)));(()=>{function e(e,t){let o=document.createElement(e);if(!t)return o;if(t.attributes)for(let[e,a]of Object.entries(t.attributes))a?o.setAttribute(e,a):o.removeAttribute(e);t.style&&Object.assign(o.style,t.style);let{style:a,attributes:i,...n}=t;return Object.assign(o,n),o}var t="https://raw.githubusercontent.com/sanoojes/Spicetify-Lucid/refs/heads/main",o="https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@main",a="2.1.3",i="lucid-guided-tour",n=[`${t}/src/workers/getColor.js`,`${o}/src/workers/getColor.js`],r="LUCID_COLOR_SCRIPT_CACHE",s="lucid-current-version",l=[`${t}/changelog.json`,`${o}/changelog.json`],c="lucid-changelog-data",d=[`${t}/src/icons.css`,`${o}/src/icons.css`,`${t}/styles/icons.css`,`${o}/styles/icons.css`],p=".Root__main-view [data-overlayscrollbars-viewport], .Root__main-view .os-viewport, .Root__main-view .main-view-container > .main-view-container__scroll-node:not([data-overlayscrollbars-initialize]), .Root__main-view .main-view-container__scroll-node > [data-overlayscrollbars-viewport], .main-view-container__scroll-node div:nth-child(2)",u=".under-main-view",h=".main-entityHeader-gradient, .XUwMufC5NCgIyRMyGXLD",g='url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@main/assets/placeholder.png")',m={showChangelog:!0,position:"nav",background:{mode:"static",options:{static:{isCustomImage:!1,filter:{blur:32,brightness:60,saturate:150}},solid:{color:{hex:"#1a211c",alpha:100}},animated:{time:120,filter:{blur:32,brightness:60,saturate:150}}}},color:{customColor:{hex:"#00ffa1",alpha:100},isTonal:!0,isCustom:!1,isDynamic:!1,extractorOptions:{pixels:36e4,distance:.1,hueDistance:.2,lightnessDistance:.2,saturationDistance:.2}},pages:{homeCardGap:8,panelGap:4,isNewHome:!1,isFlexyHome:!0,hideHomeHeader:!1,style:"card",imageStyle:"default",umv:{type:"normal",isScaling:!0,isScroll:!1,options:{expanded:{filter:{blur:0}},custom:{url:"https://picsum.photos/1920/1080?random",filter:{blur:8}},normal:{filter:{blur:8}},npv:{filter:{blur:8}}}}},border:{thickness:1,color:{hex:"#454545",alpha:50},style:"solid"},control:{height:40},font:{fontFamily:"Outfit",fontUrl:"https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap",isGoogleFonts:!0},grains:{type:"starry"},rightSidebar:{isCustomBg:!1,mode:"normal",position:"bottom right",blur:16,size:240,color:{hex:"#1a211c",alpha:50}},playbar:{type:"normal",hideIcons:!0,options:{normal:{height:80,paddingX:8,bgColor:{hex:"",alpha:50},bgOpacity:100,imageRadius:8,borderRadius:8,backdropFilter:{blur:32,saturate:150,brightness:60}},compact:{height:64,paddingX:8,bgColor:{hex:"",alpha:50},bgOpacity:100,imageRadius:8,borderRadius:8,backdropFilter:{blur:32,saturate:150,brightness:60}}},isFloating:!0},customImage:{type:"url",options:{url:{data:"https://picsum.photos/1920/1080?random"},local:null}},topbar:{isCustomColor:!1,backdropFilter:{blur:32,brightness:75,contrast:80,grayscale:25,saturate:200},bgColor:{hex:"#1e201d",alpha:20}}},b=t=>{let o=document.querySelector(`#style-${t}`);return o||(o=e("style",{id:`style-${t}`}),document.head.appendChild(o)),o},f=(e,t=!1,o)=>{for(;!Spicetify.showNotification;)setTimeout(f,500);console.debug(`Notification: ${e} (Error: ${t}, Timeout: ${o})`),Spicetify.showNotification(e,t,o)};var y,v,w=()=>{try{!function(){for(let t of d)if(!document.querySelector(`link[href="${t}"]`)){let o=e("link",{rel:"stylesheet",href:t});document.head.appendChild(o)}}();let t=(e,t=!1)=>t?o.get(e).replace(/[{0}{1}«»”“]/g,"").trim():o.get(e),o=Spicetify.Locale;if(!o)return;let a={home:t("view.web-player-home"),browse:t("browse"),pause:t("pause"),play:t("play"),close:t("close"),openMiniPlayer:t("miniplayer.open"),createPlaylist:t("contextmenu.create-playlist"),createButton:t("web-player.your-library-x.create.button-label"),fullscreen:t("npv.full-screen"),closeBtn:t("close_button_action"),duration:t("sort.duration"),search:t("navbar.search"),queue:t("playback-control.queue"),searchPlaylist:t("playlist.search_in_playlist"),download:t("download.download"),copyTrackLink:t("context-menu.copy-track-link"),moreContext:t("more.label.context",!0),downloadContext:t("contextmenu.download"),friendActivity:t("buddy-feed.friend-activity"),whatsNew:t("web-player.whats-new-feed.button-label"),skipForward:t("playback-control.skip-forward"),skipBack:t("playback-control.skip-back"),disableShuffle:t("playback-control.disable-shuffle"),enableShuffle:t("playback-control.enable-shuffle"),disableShuffleGeneric:t("web-player.smart-shuffle.button-disable-shuffle-generic"),disableShuffleSpecific:t("web-player.smart-shuffle.button-disable-shuffle-specific",!0),enableShuffleGeneric:t("web-player.smart-shuffle.button-enable-shuffle-generic"),enableShuffleSpecific:t("web-player.smart-shuffle.button-enable-shuffle-specific",!0),enableSmartShuffleSpecific:t("web-player.smart-shuffle.button-enable-smart-shuffle-specific",!0),enableSmartShuffleGeneric:t("web-player.smart-shuffle.button-enable-smart-shuffle-generic"),enableRepeat:t("playback-control.enable-repeat"),enableRepeatOne:t("playback-control.enable-repeat-one"),disableRepeat:t("playback-control.disable-repeat")};b("lucid-icon-patch").innerHTML=`\n .main-yourLibraryX-navLink[aria-label="${a.home}"] path,\n button[aria-label="${a.home}"] path {\n \td: var(--home-icon-24);\n }\n .main-yourLibraryX-navLink[aria-label="${a.home}"].active path,\n .main-globalNav-navLinkActive[aria-label="${a.home}"] path {\n \td: var(--home-filled-icon-24);\n }\n .main-topBar-buddyFeed[aria-label*="${a.whatsNew}"] svg,\n .main-topBar-buddyFeed[aria-label*="${a.friendActivity}"] svg {\n \ttransform: scale(1.1);\n }\n \n .main-topBar-buddyFeed[aria-label*="${a.friendActivity}"] svg path {\n \td: var(--people-icon);\n }\n .main-topBar-buddyFeed[aria-label*="${a.friendActivity}"] .Svg-img-icon-small-textBase path {\n \td: var(--people-filled-icon);\n }\n .main-topBar-buddyFeed[aria-label*="${a.whatsNew}"] svg path {\n \td: var(--bell-icon);\n }\n .main-topBar-buddyFeed .Svg-img-icon-small[aria-label*="${a.whatsNew}"] .Svg-img-icon-small-textBase path {\n \td: var(--bell-filled-icon);\n }\n .player-controls__left button[aria-label*="${a.disableShuffle}"] path:nth-of-type(n+2),\n .player-controls__left button[aria-label*="${a.disableShuffleSpecific}"] path:nth-of-type(n+2),\n .player-controls__left button[aria-label*="${a.disableShuffleGeneric}"] path:nth-of-type(n+2),\n .player-controls__left button[aria-label*="${a.enableShuffle}"] path:nth-of-type(n+2),\n .player-controls__left button[aria-label*="${a.enableShuffleSpecific}"] path:nth-of-type(n+2),\n .player-controls__left button[aria-label*="${a.enableShuffleGeneric}"] path:nth-of-type(n+2),\n .player-controls__left button[aria-label*="${a.enableSmartShuffleGeneric}"] path:nth-of-type(n+2),\n .player-controls__left button[aria-label*="${a.enableSmartShuffleSpecific}"] path:nth-of-type(n+2),\n .Root__globalNav button[aria-label="${a.browse}"] path:nth-of-type(n + 2) {\n \tdisplay: none;\n }\n .Root__globalNav .main-globalNav-navLink.custom-navlink[aria-label*="Marketplace"] path {\n \td: var(--appstore-icon-24);\n \ttransform: scale(3) !important;\n }\n .Root__globalNav .main-globalNav-navLinkActive.custom-navlink[aria-label*="Marketplace"] path {\n \td: var(--appstore-filled-icon-24);\n }\n .Root__globalNav .IconContainer-leading:first-child svg path,\n .Root__globalNav .IconContainer-leading:has(button[aria-label*="${a.search}"]) div > svg path {\n \td: var(--search-icon-24);\n }\n .Root__globalNav button[aria-label="${a.browse}"] path {\n \td: var(--compass-icon-24);\n }\n .Root__globalNav button[aria-label="${a.browse}"].j4xi27AJ3oy5qZ8CGhhQ path {\n \td: var(--compass-filled-icon-24);\n }\n .player-controls__buttons .player-controls__left button[data-testid="control-button-skip-back"] path,\n .player-controls__buttons .player-controls__left button[aria-label*="${a.skipBack}"] path {\n   fill: var(--clr-on-surface);\n   d: var(--prev-icon)}\n \n .player-controls__buttons .player-controls__right button[data-testid="control-button-skip-forward"] path,\n .player-controls__buttons .player-controls__right button[aria-label="${a.skipForward}"] path {\n   fill: var(--clr-on-surface);\n   d: var(--next-icon)}\n \n .player-controls__left button[aria-label*="${a.disableShuffle}"],\n .player-controls__left button[aria-label*="${a.disableShuffleSpecific}"],\n .player-controls__left button[aria-label*="${a.disableShuffleGeneric}"],\n .player-controls__left button[aria-label*="${a.enableShuffle}"],\n .player-controls__left button[aria-label*="${a.enableShuffleSpecific}"],\n .player-controls__left button[aria-label*="${a.enableShuffleGeneric}"],\n .player-controls__left button[aria-label*="${a.enableSmartShuffleGeneric}"],\n .player-controls__left button[aria-label*="${a.enableSmartShuffleSpecific}"],\n .player-controls__right button[aria-label="${a.enableRepeat}"],\n .player-controls__right button[aria-label="${a.enableRepeatOne}"],\n .player-controls__right button[aria-label="${a.disableRepeat}"] {\n \t--encore-graphic-size-decorative-smaller: 22px;\n \t--encore-control-size-smaller: 22px}\n \n .player-controls__right button[aria-label="${a.enableRepeat}"] path {\n \td: var(--disable-repeat-icon)}\n .player-controls__right button[aria-label="${a.enableRepeatOne}"] path {\n   d: var(--repeat-icon)}\n \n .player-controls__right button[aria-label="${a.disableRepeat}"] path {\n   d: var(--repeat-one-icon)}\n \n .player-controls__left button[aria-label*="${a.enableShuffle}"] path,\n .player-controls__left button[aria-label*="${a.enableShuffleSpecific}"] path,\n .player-controls__left button[aria-label*="${a.enableShuffleGeneric}"] path {\n \td: var(--disable-shuffle-icon)}\n \n .player-controls__left button[aria-label*="${a.disableShuffleSpecific}"] path,\n .player-controls__left button[aria-label*="${a.disableShuffle}"] path,\n .player-controls__left button[aria-label*="${a.enableSmartShuffleGeneric}"] path,\n .player-controls__left button[aria-label*="${a.enableSmartShuffleSpecific}"] path {\n \td: var(--shuffle-icon)}\n \n .player-controls__left button[aria-label*="${a.disableShuffleSpecific}"] path,\n .player-controls__left button[aria-label*="${a.disableShuffleGeneric}"] path {\n \td: var(--smart-shuffle-icon)}\n \n .main-actionBar-ActionBarRow button[aria-label*="${a.enableShuffle}"] path,\n .main-actionBar-ActionBarRow button[aria-label*="${a.enableShuffleSpecific}"] path,\n .main-actionBar-ActionBarRow button[aria-label*="${a.enableShuffleGeneric}"] path {\n   d: var(--disable-shuffle-icon-24, var(--disable-shuffle-icon))}\n \n .main-actionBar-ActionBarRow button[aria-label*="${a.disableShuffleSpecific}"] path,\n .main-actionBar-ActionBarRow button[aria-label*="${a.disableShuffle}"] path,\n .main-actionBar-ActionBarRow button[aria-label*="${a.enableSmartShuffleGeneric}"] path,\n .main-actionBar-ActionBarRow button[aria-label*="${a.enableSmartShuffleSpecific}"] path {\n   d: var(--shuffle-icon-24, var(--shuffle-icon))}\n \n .main-actionBar-ActionBarRow button[aria-label*="${a.disableShuffleSpecific}"] path,\n .main-actionBar-ActionBarRow button[aria-label*="${a.disableShuffleGeneric}"] path {\n   d: var(--smart-shuffle-icon-24, var(--smart-shuffle-icon))}\n \n .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${a.play}"] svg[viewBox="0 0 24 24"] path {\n   d: var(--play-icon-24, var(--play-icon))}\n \n .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${a.pause}"] svg[viewBox="0 0 24 24"] path {\n   d: var(--pause-icon-24, var(--pause-icon))}\n \n .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${a.play}"] svg[viewBox="0 0 16 16"] path {\n   d: var(--play-icon)}\n \n .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${a.pause}"] svg[viewBox="0 0 16 16"] path {\n   d: var(--pause-icon)}\n \n .player-controls__buttons .player-controls__right button[data-testid="control-button-skip-forward"],\n .player-controls__buttons .player-controls__right button[aria-label="${a.skipForward}"],\n .player-controls__buttons .player-controls__left button[data-testid="control-button-skip-back"],\n .player-controls__buttons .player-controls__left button[aria-label*="${a.skipBack}"] {\n \t--encore-graphic-size-decorative-smaller: 22px;\n \t--encore-control-size-smaller: 22px;\n \tcolor: var(--subtext-color)}\n \n .player-controls__buttons button[aria-label="${a.play}"] path {\n   fill: var(--clr-on-surface);\n   d: var(--play-icon)}\n \n \n .player-controls__buttons button[aria-label="${a.pause}"] path {\n   fill: var(--clr-on-surface);\n   d: var(--pause-icon)}\n \n .player-controls__buttons > button,\n .player-controls__buttons button[data-testid=control-button-playpause] { --encore-graphic-size-decorative-smaller: 1.5rem; --encore-control-size-smaller: 1.5rem; }\n .player-controls__buttons button[data-testid=control-button-playpause],\n .player-controls__buttons button[data-testid=control-button-playpause]:hover,\n .player-controls__buttons button[data-testid=control-button-playpause] span:hover,\n .player-controls__buttons button[data-testid=control-button-playpause] span { background: none !important; color: var(--clr-on-surface) }\n \n .x-downloadButton-DownloadButton button[aria-label="${a.download}"] path,\n .x-downloadButton-DownloadButton button[aria-label="${a.downloadContext}"] path {\n   d: var(--download-icon-24)}\n   \n svg path[d="M3 8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm6.5 0a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zM16 8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"],\n .Root__right-sidebar button[aria-label*="${a.moreContext}"] path{\n   d: var(--more-horizontal-icon)}\n \n .main-actionBar-ActionBar button[aria-label*="${a.moreContext}"] path {\n   d: var(--more-horizontal-icon-24)}\n \n x-filterBox-expandButton[aria-label*="${a.search}"] path,\n x-filterBox-expandButton[aria-label*="${a.searchPlaylist}"] path,\n .x-filterBox-searchIcon path {\n   d: var(--search-icon)}\n \n button[aria-label="${a.copyTrackLink}"] svg[viewBox="0 0 16 16"] path,\n button[aria-label="${a.copyTrackLink}"] svg[viewBox="0 0 16 16"] path,\n button[aria-label="${a.copyTrackLink}"] svg[viewBox="0 0 16 16"] path{\n   d: var(--share-icon)}\n \n button[aria-label="${a.copyTrackLink}"] svg[viewBox="0 0 24 24"] path,\n button[aria-label="${a.copyTrackLink}"] svg[viewBox="0 0 24 24"] path,\n button[aria-label="${a.copyTrackLink}"] svg[viewBox="0 0 24 24"] path{\n   d: var(--share-icon-24)}\n \n svg path[d="M15 14.5H5V13h10v1.5zm0-5.75H5v-1.5h10v1.5zM15 3H5V1.5h10V3zM3 3H1V1.5h2V3zm0 11.5H1V13h2v1.5zm0-5.75H1v-1.5h2v1.5z"],\n button[aria-controls="sort-and-view-picker"] path,\n .x-sortBox-sortDropdown path {\n   d: var(--text-bullet-list-icon)}\n \n svg path[d="M15.5 13.5H.5V12h15v1.5zm0-4.75H.5v-1.5h15v1.5zm0-4.75H.5V2.5h15V4z"]{\n   d: var(--list-icon)}\n \n div[data-testid="PanelHeader_CloseButton"] button path,\n .Root__right-sidebar button[aria-label="${a.closeBtn}"] path,\n .Root__right-sidebar button[aria-label="${a.close}"] path{\n   d: var(--dismiss-icon)}\n \n .main-trackList-trackListRowGrid button[aria-label="${a.duration}"] path{\n   d: var(--clock-icon)}\n \n button[aria-label="${a.createPlaylist}"] path,\n button[aria-label="${a.createButton}"] path,\n svg path[d="M15.25 8a.75.75 0 0 1-.75.75H8.75v5.75a.75.75 0 0 1-1.5 0V8.75H1.5a.75.75 0 0 1 0-1.5h5.75V1.5a.75.75 0 0 1 1.5 0v5.75h5.75a.75.75 0 0 1 .75.75z"]{\n   d: var(--add-icon)}\n \n svg path[d="M6.53 9.47a.75.75 0 0 1 0 1.06l-2.72 2.72h1.018a.75.75 0 0 1 0 1.5H1.25v-3.579a.75.75 0 0 1 1.5 0v1.018l2.72-2.72a.75.75 0 0 1 1.06 0zm2.94-2.94a.75.75 0 0 1 0-1.06l2.72-2.72h-1.018a.75.75 0 1 1 0-1.5h3.578v3.579a.75.75 0 0 1-1.5 0V3.81l-2.72 2.72a.75.75 0 0 1-1.06 0z"],\n button[data-testid="fullscreen-mode-button"] path,\n button[aria-label="${a.fullscreen}"] path{\n   d: var(--arrow-maximize-icon);\n }\n \n svg path[d="M15 15H1v-1.5h14V15zm0-4.5H1V9h14v1.5zm-14-7A2.5 2.5 0 0 1 3.5 1h9a2.5 2.5 0 0 1 0 5h-9A2.5 2.5 0 0 1 1 3.5zm2.5-1a1 1 0 0 0 0 2h9a1 1 0 1 0 0-2h-9z"],\n button[data-testid="control-button-queue"] path,\n button[aria-label="${a.queue}"] path{\n   /* d: var(--queue-icon); */ /* TODO: add new queue icon */\n }\n \n \n button[aria-label="${a.openMiniPlayer}"] path,\n button[data-testid="pip-toggle-button"] path{\n   d: var(--pip-icon);\n }\n `}catch(e){console.error("Error patching icons.",e),f("Error patching icons.",!0,5e3)}},S={defaultMerge:Symbol("deepmerge-ts: default merge"),skip:Symbol("deepmerge-ts: skip")};S.defaultMerge;function k(e,t){return t}function C(e,t){return e.filter((e=>void 0!==e))}function _(e){return"object"!=typeof e||null===e?0:Array.isArray(e)?2:function(e){if(!B.includes(Object.prototype.toString.call(e)))return!1;let{constructor:t}=e;if(void 0===t)return!0;let o=t.prototype;return!(null===o||"object"!=typeof o||!B.includes(Object.prototype.toString.call(o))||!o.hasOwnProperty("isPrototypeOf"))}(e)?1:e instanceof Set?3:e instanceof Map?4:5}function x(e,t){return"object"==typeof e&&Object.prototype.propertyIsEnumerable.call(e,t)}function E(e){let t=0,o=e[0]?.[Symbol.iterator]();return{[Symbol.iterator]:()=>({next(){for(;;){if(void 0===o)return{done:!0,value:void 0};let a=o.next();if(!0!==a.done)return{done:!1,value:a.value};t+=1,o=e[t]?.[Symbol.iterator]()}}})}}(v=y||(y={}))[v.NOT=0]="NOT",v[v.RECORD=1]="RECORD",v[v.ARRAY=2]="ARRAY",v[v.SET=3]="SET",v[v.MAP=4]="MAP",v[v.OTHER=5]="OTHER";var B=["[object Object]","[object Module]"];var I={mergeRecords:function(e,t,o){let a={};for(let i of function(e){let t=new Set;for(let o of e)for(let e of[...Object.keys(o),...Object.getOwnPropertySymbols(o)])t.add(e);return t}(e)){let n=[];for(let t of e)x(t,i)&&n.push(t[i]);if(0===n.length)continue;let r=t.metaDataUpdater(o,{key:i,parents:e}),s=$(n,t,r);s!==S.skip&&("__proto__"===i?Object.defineProperty(a,i,{value:s,configurable:!0,enumerable:!0,writable:!0}):a[i]=s)}return a},mergeArrays:function(e){return e.flat()},mergeSets:function(e){return new Set(E(e))},mergeMaps:function(e){return new Map(E(e))},mergeOthers:function(e){return e.at(-1)}};function L(...e){return function(e,t){let o=function(e,t){return{defaultMergeFunctions:I,mergeFunctions:{...I,...Object.fromEntries(Object.entries(e).filter((([e,t])=>Object.hasOwn(I,e))).map((([e,t])=>!1===t?[e,I.mergeOthers]:[e,t])))},metaDataUpdater:e.metaDataUpdater??k,deepmerge:t,useImplicitDefaultMerging:e.enableImplicitDefaultMerging??!1,filterValues:!1===e.filterValues?void 0:e.filterValues??C,actions:S}}(e,a);function a(...e){return $(e,o,t)}return a}({})(...e)}function $(e,t,o){let a=t.filterValues?.(e,o)??e;if(0===a.length)return;if(1===a.length)return F(a,t,o);let i=_(a[0]);if(0!==i&&5!==i)for(let e=1;e<a.length;e++)if(_(a[e])!==i)return F(a,t,o);switch(i){case 1:return function(e,t,o){let a=t.mergeFunctions.mergeRecords(e,t,o);return a===S.defaultMerge||t.useImplicitDefaultMerging&&void 0===a&&t.mergeFunctions.mergeRecords!==t.defaultMergeFunctions.mergeRecords?t.defaultMergeFunctions.mergeRecords(e,t,o):a}(a,t,o);case 2:return function(e,t,o){let a=t.mergeFunctions.mergeArrays(e,t,o);return a===S.defaultMerge||t.useImplicitDefaultMerging&&void 0===a&&t.mergeFunctions.mergeArrays!==t.defaultMergeFunctions.mergeArrays?t.defaultMergeFunctions.mergeArrays(e):a}(a,t,o);case 3:return function(e,t,o){let a=t.mergeFunctions.mergeSets(e,t,o);return a===S.defaultMerge||t.useImplicitDefaultMerging&&void 0===a&&t.mergeFunctions.mergeSets!==t.defaultMergeFunctions.mergeSets?t.defaultMergeFunctions.mergeSets(e):a}(a,t,o);case 4:return function(e,t,o){let a=t.mergeFunctions.mergeMaps(e,t,o);return a===S.defaultMerge||t.useImplicitDefaultMerging&&void 0===a&&t.mergeFunctions.mergeMaps!==t.defaultMergeFunctions.mergeMaps?t.defaultMergeFunctions.mergeMaps(e):a}(a,t,o);default:return F(a,t,o)}}function F(e,t,o){let a=t.mergeFunctions.mergeOthers(e,t,o);return a===S.defaultMerge||t.useImplicitDefaultMerging&&void 0===a&&t.mergeFunctions.mergeOthers!==t.defaultMergeFunctions.mergeOthers?t.defaultMergeFunctions.mergeOthers(e):a}function P(e,t){if(!t)return e;let o=t.split(/[.\[\]'"]/).filter(Boolean),a=e;for(let e of o){if(!a||"object"!=typeof a||!(e in a))return;a=a[e]}return a}function T(e,t){if(e===t)return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;let o=Object.keys(e),a=Object.keys(t);if(o.length!==a.length)return!1;for(let a of o)if(!Object.prototype.hasOwnProperty.call(t,a)||e[a]!==t[a])return!1;return!0}var M=class{constructor(e,t={}){if(this.subscribers=[],this.options={persist:!1,localStorageKey:"storeState",...t},this.options.persist&&this.options.localStorageKey){let t=localStorage.getItem(this.options.localStorageKey);if(!t)return void(this.state=e);try{let o=JSON.parse(t);this.state=L(e,o)}catch(t){console.error("Error parsing stored state from localStorage:",t),this.state=e}}else this.state=e}getState(){return this.state}setState(e,t){let o={...this.state},a=e(this.state,t);this.updateStateAndNotify(a,o)}updateStateAndNotify(e,t){e!==this.state&&(this.state=e,this.notifySubscribers(t),this.options.persist&&this.persist())}subscribe(e,t){let o={subscriber:e,path:t};return this.subscribers.push(o),()=>{this.subscribers=this.subscribers.filter((e=>e!==o))}}notifySubscribers(e){for(let t of this.subscribers){let{subscriber:o,path:a}=t;if(!T(P(e,a),P(this.state,a))){let e=performance.now();try{o(this.state)}catch(e){console.error(`Subscriber at path "${a}" threw an error:`,e)}let t=performance.now()-e;t>10&&console.warn(`Slow subscriber at path "${a}" took ${t.toFixed(2)}ms. Subscriber: ${o}`)}}}persist(){try{this.options.localStorageKey?localStorage.setItem(this.options.localStorageKey,JSON.stringify(this.state)):console.warn("localStorageKey is not defined, skipping persistence.")}catch(e){console.error("Error saving state to localStorage:",e)}}};function R(e){return null!==e&&"object"==typeof e}function H(e){return R(e)&&(void 0===e.blur||"number"==typeof e.blur)&&(void 0===e.brightness||"number"==typeof e.brightness)&&(void 0===e.contrast||"number"==typeof e.contrast)&&(void 0===e.grayscale||"string"==typeof e.grayscale)&&(void 0===e.hueRotate||"string"==typeof e.hueRotate)&&(void 0===e.invert||"string"==typeof e.invert)&&(void 0===e.opacity||"number"==typeof e.opacity)&&(void 0===e.saturate||"number"==typeof e.saturate)&&(void 0===e.sepia||"string"==typeof e.sepia)}function A(e){return R(e)&&"string"==typeof e.hex&&"number"==typeof e.alpha}function O(e){return!(!R(e)||"boolean"!=typeof e.isCustom||"url"!==e.type&&"local"!==e.type||!R(e.options))&&("url"===e.type?function(e){return R(e)&&"string"==typeof e.url}(e.options.url):"local"===e.type&&function(e){return R(e)&&Array.isArray(e.selectedIds)&&e.selectedIds.every((e=>"number"==typeof e))&&R(e.slideshow)&&"boolean"==typeof e.slideshow.isSlideshow&&"number"==typeof e.slideshow.timeDelay}(e.options.local))}function N(e){return R(e)&&function(e){return R(e)&&O(e.customImage)&&(void 0===e.filter||H(e.filter))}(e.static)&&function(e){return R(e)&&A(e.color)}(e.solid)&&function(e){return R(e)&&H(e.filter)}(e.animated)}function U(e){return R(e)&&("npv"===e.type||"normal"===e.type)&&function(e){return!!R(e)&&["normal","expanded","npv"].every((t=>{let o=e[t];return R(o)&&"boolean"==typeof o.isScaling&&"boolean"==typeof o.isScroll&&(null===o.filter||H(o.filter))}))}(e.options)}function V(e){return!!R(e)&&["compact","normal"].every((t=>function(e){return R(e)&&H(e.backdropFilter)&&"number"==typeof e.height&&"number"==typeof e.paddingX&&A(e.bgColor)&&"number"==typeof e.bgOpacity&&"number"==typeof e.borderRadius}(e[t])))}function D(e){return R(e)&&("context-menu"===e.position||"nav"===e.position)&&function(e){return R(e)&&"string"==typeof e.mode&&("static"===e.mode||"solid"===e.mode||"animated"===e.mode)&&N(e.options)}(e.background)&&function(e){return R(e)&&"number"==typeof e.thickness&&A(e.color)&&"string"==typeof e.style}(e.border)&&function(e){return R(e)&&"number"==typeof e.panelGap&&"boolean"==typeof e.hideHomeHeader&&"string"==typeof e.style&&U(e.umv)}(e.pages)&&function(e){return R(e)&&"boolean"==typeof e.isDynamic&&"boolean"==typeof e.isCustom&&"boolean"==typeof e.isTonal&&A(e.customColor)}(e.color)&&R(e.control)&&"number"==typeof e.control.height&&R(e.font)&&"string"==typeof e.font.fontFamily&&("string"==typeof e.font.fontUrl||null===e.font.fontUrl)&&"boolean"==typeof e.font.isGoogleFonts&&function(e){return R(e)&&("default"===e.type||"starry"===e.type||"none"===e.type)}(e.grains)&&function(e){return R(e)&&("compact"===e.type||"normal"===e.type)&&V(e.options)&&"boolean"==typeof e.isFloating&&"boolean"==typeof e.hideIcons}(e.playbar)&&function(e){return R(e)&&("compact"===e.mode||"normal"===e.mode)&&("bottom left"===e.position||"bottom right"===e.position||"top left"===e.position||"top right"===e.position)&&"number"==typeof e.blur&&"number"==typeof e.size&&"boolean"==typeof e.isCustomBg&&A(e.color)}(e.rightSidebar)}var z=new class extends M{constructor(e=m,t={persist:!0,localStorageKey:"lucid-theme-settings"}){super(e,t)}setChangelog(e){this.setState((t=>({...t,showChangelog:e})))}setPages(e){this.setState((t=>({...t,pages:{...t.pages,...e}})))}setUMV(e){this.setState((t=>({...t,pages:{...t.pages,umv:{...t.pages.umv,...e}}})))}setUMVOption(e,t){this.setState((o=>({...o,pages:{...o.pages,umv:{...o.pages.umv,options:{...o.pages.umv.options,[e]:{...o.pages.umv.options[e],...t}}}}})))}setUMVFilter(e,t){this.setState((o=>({...o,pages:{...o.pages,umv:{...o.pages.umv,options:{...o.pages.umv.options,[e]:{...o.pages.umv.options[e],filter:{...o.pages.umv.options[e].filter,...t}}}}}})))}setCustomImageType(e){this.setState((t=>({...t,customImage:{...t.customImage,type:e}})))}setCustomImageOptions(e,t){this.setState((o=>({...o,customImage:{...o.customImage,options:{...o.customImage.options,[e]:{...o.customImage.options[e],...t}}}})))}setPosition(e){this.setState((t=>({...t,position:e})))}setBackgroundMode(e){this.setState((t=>({...t,background:{...t.background,mode:e}})))}setStaticBackgroundOptions(e){this.setState((t=>({...t,background:{...t.background,options:{...t.background.options,static:{...t.background.options.static,...e}}}})))}setStaticBackgroundFilter(e){this.setState((t=>({...t,background:{...t.background,options:{...t.background.options,static:{...t.background.options.static,filter:{...t.background.options.static.filter,...e}}}}})))}setAnimatedBackgroundFilter(e){this.setState((t=>({...t,background:{...t.background,options:{...t.background.options,animated:{...t.background.options.animated,filter:{...t.background.options.animated.filter,...e}}}}})))}setStaticBgFilter(e){this.setState((t=>({...t,background:{...t.background,options:{...t.background.options,static:{...t.background.options.static,filter:{...t.background.options.static.filter,...e}}}}})))}setSolidBackgroundColor(e){this.setState((t=>({...t,background:{...t.background,options:{...t.background.options,solid:{...t.background.options.solid,color:{...t.background.options.solid.color,...e}}}}})))}setAnimatedBackgroundOptions(e){this.setState((t=>({...t,background:{...t.background,options:{...t.background.options,animated:{...t.background.options.animated,...e}}}})))}setBorder(e){this.setState((t=>({...t,border:{...t.border,...e}})))}setBorderColor(e){this.setState((t=>({...t,border:{...t.border,color:{...t.border.color,...e}}})))}setControlHeight(e){this.setState((t=>({...t,control:{...t.control,height:e}})))}setFont(e){this.setState((t=>({...t,font:{...t.font,...e}})))}setGrains(e){this.setState((t=>({...t,grains:{...t.grains,...e}})))}setRightSidebar(e){this.setState((t=>({...t,rightSidebar:{...t.rightSidebar,...e}})))}setColor(e){this.setState((t=>({...t,color:{...t.color,...e}})))}setColorExtractorOptions(e){this.setState((t=>({...t,color:{...t.color,extractorOptions:{...t.color.extractorOptions,...e}}})))}setPageStyle(e){this.setState((t=>({...t,pages:{...t.pages,style:e}})))}setPageImageStyle(e){this.setState((t=>({...t,pages:{...t.pages,imageStyle:e}})))}setPlaybar(e){this.setState((t=>({...t,playbar:{...t.playbar,...e}})))}setPlaybarOptions(e,t){this.setState((o=>({...o,playbar:{...o.playbar,options:{...o.playbar.options,[e]:{...o.playbar.options[e],...t}}}})))}setPlaybarFilter(e,t){this.setState((o=>({...o,playbar:{...o.playbar,options:{...o.playbar.options,[e]:{...o.playbar.options[e],backdropFilter:{...o.playbar.options[e].backdropFilter,...t}}}}})))}setTopbarFilter(e){this.setState((t=>({...t,topbar:{...t.topbar,backdropFilter:{...t.topbar.backdropFilter,...e}}})))}setTopbarColor(e){this.setState((t=>({...t,topbar:{...t.topbar,bgColor:{...t.topbar.bgColor,...e}}})))}setIsCustomTopbarColor(e){this.setState((t=>({...t,topbar:{...t.topbar,isCustomColor:e}})))}setRightSidebarColor(e){this.setState((t=>({...t,rightSidebar:{...t.rightSidebar,color:{...t.rightSidebar.color,...e}}})))}setGrainsType(e){this.setState((t=>({...t,grains:{...t.grains,type:e}})))}setDynamicColor(e){this.setState((t=>({...t,color:{...t.color,isDynamic:e}})))}setIsCustomColor(e){this.setState((t=>({...t,color:{...t.color,isCustom:e}})))}setCustomColor(e){this.setState((t=>({...t,color:{...t.color,customColor:{...t.color.customColor,...e}}})))}setTonalColor(e){this.setState((t=>({...t,color:{...t.color,isTonal:e}})))}resetState(){try{this.setState((()=>m)),localStorage.removeItem(i),localStorage.removeItem("LUCID_GUIDE_SCRIPT_CACHE"),localStorage.removeItem(r),localStorage.removeItem(c),localStorage.removeItem(s),window.location.reload()}catch(e){f("Error reseting settings.",!0,5e3),console.error("Error reseting settings.",e)}}exportSettings(){let e=z.getState();return JSON.stringify(e,null,0)}importSettings(e){try{let t=JSON.parse(e);D(t)?(z.setState((e=>L(e,t))),f("Settings imported successfully!",!1,5e3)):(console.error("Invalid settings format."),f("Import failed: Invalid settings format.",!0,5e3))}catch(e){console.error("Error importing settings:",e),f("Import failed: Unable to parse settings JSON.",!0,5e3)}}},G=z;function W(t=G.getState().font){let o=b("lucid-font"),a=document.head.querySelector("#lucid-custom-font");if(t.isGoogleFonts&&t.fontUrl){a?a.href!==t.fontUrl&&(a.href=t.fontUrl):(a=e("link",{id:"lucid-custom-font",rel:"preload",href:t.fontUrl,as:"style",crossOrigin:"anonymous"}),document.head.appendChild(a));let o=document.head.querySelector("#lucid-custom-font-style");o?o.href!==t.fontUrl&&(o.href=t.fontUrl):(o=e("link",{id:"lucid-custom-font-style",rel:"stylesheet",href:t.fontUrl,crossOrigin:"anonymous"}),document.head.appendChild(o))}else{a&&a.remove();let e=document.head.querySelector("#lucid-custom-font-style");e&&e.remove()}let i=t.isGoogleFonts&&t.fontUrl?function(e){try{let t=new URL(e).searchParams.get("family");return t?t.split(":")[0].split(";")[0].replace(/\+/g," "):null}catch(e){return console.error("Error parsing Google Fonts URL:",e),null}}(t.fontUrl):t.fontFamily;o.innerText=`:root,* { --custom-font: "${i}"; font-family: var(--custom-font) !important; }`}var q=null,j=null;function K(e=G.getState().pages){let t=`playlist-${e.style}`;q!==t&&(q?document.body.classList.replace(q,t):document.body.classList.add(t),q=t);let o=`playlist-image-${e.imageStyle}`;j!==o&&(j?document.body.classList.replace(j,o):document.body.classList.add(o),j=o),e.hideHomeHeader?document.body.classList.remove("hide-home-header"):document.body.classList.add("hide-home-header"),document.body.style.setProperty("--custom-panel-gap",`${e.panelGap}px`),document.body.style.setProperty("--home-card-gap",`${e.homeCardGap}px`),document.body.classList.toggle("new-home",e.isNewHome),document.body.classList.toggle("flexy-home",e.isNewHome&&e.isFlexyHome)}G.subscribe((e=>{K(e.pages)}),"pages");var Z=()=>document.querySelector(".Root__right-sidebar .main-nowPlayingView-nowPlayingWidget .main-image-image")?.src||"",X=async(e,t,o=3)=>{for(let a=0;a<=o;a++)try{return await Spicetify.GraphQL.Request({...e,operation:"query",value:null},t)}catch(t){if(t instanceof Error&&t.message.includes("DUPLICATE_REQUEST_ERROR")&&a<o){console.warn(`Retrying ${e.name}... (${a+1}/${o})`),await new Promise((e=>setTimeout(e,1e3)));continue}throw console.error(`Error in ${e.name}:`,t),t}return null},J=async e=>{if("/collection/tracks"===e)return"https://misc.scdn.co/liked-songs/liked-songs-300.jpg";let t=(e=>{let t=e.match(/\/(playlist|artist|album|user|show|collection)\/([^/]+)/);if(!t)return console.warn("No valid type or ID found in pathname:",e),null;let[,o,a]=t;return`spotify:${o}:${a}`})(e);if(!t)return null;let[,o,a]=t.split(":");try{switch(o){case"playlist":case"show":return(await Spicetify.Platform.PlaylistAPI.getMetadata(t)).images[0]?.url||null;case"artist":{let e=(await(e=>X({name:"queryArtistOverview",sha256Hash:"35648a112beb1794e39ab931365f6ae4a8d45e65396d641eeda94e4003d41497"},{uri:e,includePrerelease:!0,locale:null}))(t))?.data?.artistUnion?.visuals;return e?.headerImage?.sources[0]?.url||e?.avatarImage?.sources[0]?.url||null}case"album":{let e=(await(e=>X({name:"getAlbum",sha256Hash:"469874edcad37b7a379d4f22f0083a49ea3d6ae097916120d9bbe3e36ca79e9d"},{uri:e,locale:null,offset:0,limit:50}))(t))?.data?.albumUnion?.coverArt?.sources;return e?.[2]?.url||e?.[0]?.url||null}case"user":return(await Spicetify.Platform.RequestBuilder.build().withHost("https://spclient.wg.spotify.com/user-profile-view/v3").withPath(`/profile/${a}`).send())?.body?.image_url||null;default:return null}}catch(e){return console.error(`Error fetching ${o} artwork:`,e),null}},Y=new M({url:null});async function Q(){try{let e=await(async()=>{for(;!Spicetify.Player?.data;)await new Promise((e=>setTimeout(e,50)));let e=Spicetify.Player.data?.item;return e&&e.metadata?[e.metadata.image_xlarge_url,e.metadata.image_large_url,e.metadata.image_url,e.metadata.image_small_url].find((e=>e))||Z()||Z():(console.error("No item or metadata found in Spicetify Player data."),"")})();Y.setState((()=>({url:e}))),document.body.style.setProperty("--npv-img-url",e?`url(${e})`:g)}catch(e){console.error("Error updating NPV state:",e),Y.setState((()=>({url:null}))),document.body.style.setProperty("--npv-img-url",g)}}async function ee(e,t,o=864e5){let a=JSON.parse(localStorage.getItem(t)||"null");if(a?.script&&(!navigator.onLine||Date.now()-a.timestamp<o))return a.script;let i=null;for(let t of e)try{let e=await fetch(t);if(e.ok){i=await e.text();break}}catch{}if(!i){if(a?.script)return a.script;throw new Error("Failed to fetch guide script from all sources.")}return localStorage.setItem(t,JSON.stringify({script:i,timestamp:Date.now()})),i}Q(),Spicetify.Player.addEventListener("songchange",Q);var te=null,oe=null,ae=b("clr-lucid");function ie(e){te&&te.postMessage({type:"color",options:e})}function ne(e){te&&te.postMessage({type:"image",options:e})}function re(e){return e.replace("spotify:image:","https://i.scdn.co/image/")}async function se(e=G.getState().color){if(await async function(){let e=await ee(n,r);if(te=function(e){try{let t=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(t),a=new Worker(o,{credentials:"omit"});return a.onerror=e=>{console.error("Worker encountered an error:",e.message||e)},a.onmessage=e=>{console.debug("Worker initialized:",e.data)},a}catch(e){return console.error("Error loading worker:",e),null}}(e),!te)return document.body.dataset.colorFromWorker="false",console.error("Failed to initialize worker from both endpoints."),void f("Failed to initialize the color worker. If this issue persists, please report it. (Dynamic and custom colors may not function properly.)",!0,5e3);document.body.dataset.colorFromWorker="true",te.onmessage=e=>{let{message:t,data:o}=e.data||{};o?(console.debug(t,"\nEvent Data:",e.data),ae.textContent=`:root,body{${o.style}}`):console.error(t??"Color not applied")},te.onerror=e=>{console.error("Worker encountered an error:",e.message||e)}}(),oe?.(),e.isDynamic){let t=Y.getState().url;return t&&ne({url:re(t),isTonal:e.isTonal,isDark:!0,extractorOptions:e?.extractorOptions??{}}),void(oe=Y.subscribe((t=>{t.url&&ne({url:re(t.url),isTonal:e.isTonal,isDark:!0,extractorOptions:e?.extractorOptions??{}})})))}e.isCustom?ie({hex:e.customColor.hex,isTonal:e.isTonal,isDark:!0}):ie({hex:"#1bc858",isTonal:e.isTonal,isDark:!0})}var le,ce=e=>Spicetify.URI.isPlaylistV1OrV2(e)?"playlist":Spicetify.URI.isArtist(e)?"artist":Spicetify.URI.isAlbum(e)?"album":Spicetify.URI.isGenre(e)?"genre":Spicetify.URI.isShow(e)?"show":Spicetify.URI.isSearch(e)?"search":Spicetify.URI.isProfile(e)?"profile":Spicetify.URI.isConcert(e)||Spicetify.URI.isArtistConcerts(e)?"concert":"other";function de(e){document.body.dataset.path=e,document.body.dataset.pageType=ce(e),"/search"===e&&(le=setInterval((()=>function(e,t=.5){let o=document.querySelectorAll(e);if(o)for(let e of o){let o=e.style.backgroundColor.match(/rgb?\((\d+),\s*(\d+),\s*(\d+)\)/);if(o&&4===o.length){let a=`${o[1]},${o[2]},${o[3]}`;e.style.setProperty("--accent-color",`${a}`),e.style.backgroundColor=`rgba(${a},${t})`}}}(".Vn9yz8P5MjIvDT8c0U6w")),300),setTimeout((()=>{clearInterval(le)}),2e3))}var pe=()=>!(!Spicetify.Platform||"Windows"!==Spicetify.Platform.operatingSystem)||!!Spicetify.Platform?.PlatformData?.os_name&&Spicetify.Platform.PlatformData.os_name.toLowerCase().includes("win");var ue=Spicetify?.Platform?.version>="1.2.46";function he(e){let{zoom:t,inverseZoom:o}={zoom:Math.round(window.outerHeight/window.innerHeight*100)/100,inverseZoom:Math.round(window.innerHeight/window.outerHeight*100)/100},a=0===e?1:e||(ue?32:64),i=b("transparent-controls");if(0===a)return void(i.textContent=`\n:root {--zoom: ${t};--inverse-zoom: ${o};}\nbody::after {content: ""; height: 0; width: 0; position: fixed; top: 0; right: 0;}`);let n=Math.round(135*o);if(n>500)return me();let r=e/t,s=32/t,l=ue?(r-Math.min(s,r))/2:0,c=a/t-2*l;if(c>500)return me();i.textContent=`\n:root {--zoom: ${t};--inverse-zoom: ${o};}\nbody:after {content: ""; height: var(--control-height, ${c}px); width: var(--control-width, ${n}px); position: fixed; top: ${l}px; right: 0; -webkit-backdrop-filter: brightness(2.1); backdrop-filter: brightness(2.1); pointer-events: none;}\nhtml[dir="rtl"] body:after{left: 0;right: inherit}\nbody.hide-transparent-controls:after{display: none; content: none;}`}function ge(e=G.getState().control.height){(async function(e){await(Spicetify?.Platform?.ControlMessageAPI?._updateUiClient?.updateTitlebarHeight({height:e})),await(Spicetify?.Platform?.UpdateAPI?._updateUiClient?.updateTitlebarHeight({height:e})),await Spicetify.CosmosAsync.post("sp://messages/v1/container/control",{type:"update_titlebar",height:`${e}px`})})(e).then((()=>he(e))).catch((e=>console.error("Failed to update titlebar:",e)))}function me(){let e=setInterval((()=>ge()),300);setTimeout((()=>{clearInterval(e)}),1e4)}var be=e=>{if(e<0||e>100)throw new Error("Alpha value must be between 0 and 100");let t=e/100,o=Math.round(255*t).toString(16).toUpperCase();return 1===o.length&&(o=`0${o}`),o};function fe(e,t,o=100){let a=e.map((e=>document.querySelector(e)));a.every((e=>e))?t(a):o>0&&setTimeout(fe,300,e,t,--o)}function ye(e=G.getState().playbar){let t=e.options[e.type];b("lucid-playbar").textContent=`\n    :root,\n    .Root__now-playing-bar{\n        --npb-height: ${t.height??80}px;\n        --npb-blur: ${t.backdropFilter.blur??32}px;\n        --npb-padding-x: ${t.paddingX??8}px;\n        --npb-saturate: ${t.backdropFilter.saturate??150}%;\n        --npb-brightness: ${t.backdropFilter.brightness??80}%;\n        --npb-border-radius: ${t.borderRadius??8}px;\n        --npb-image-radius: ${t.imageRadius??16}px;\n        --npb-bg-opacity: ${t.bgOpacity??50}%;\n        --npb-bg-color: ${t.bgColor.hex?t.bgColor.hex+be(t.bgColor.alpha):`rgba(var(--clr-surface-1-rgb), ${t.bgColor.alpha}%)`} ;\n    }`,e.isFloating?document.body.setAttribute("npb-is-floating","floating"):document.body.removeAttribute("npb-is-floating"),document.body.setAttribute("npb-type",e.type)}var ve=document.querySelector(".Root__now-playing-bar");fe([".Root__now-playing-bar"],(([e])=>{ve=e,Se()}));var we=G.getState().playbar.hideIcons;function Se(){if(!ve)return;let e=ve.offsetWidth;ve.style.setProperty("--width",`${e}px`),ke(we||e<1e3)}function ke(e=G.getState().playbar.hideIcons){ve&&(e?ve.setAttribute("hide-icons","true"):ve.removeAttribute("hide-icons"))}var Ce=new M({isFloating:!1,position:{top:16,left:16}},{persist:!0,localStorageKey:"lucid-modal-position"}),_e='<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m8.5 16.586-3.793-3.793a1 1 0 0 0-1.414 1.414l4.5 4.5a1 1 0 0 0 1.414 0l11-11a1 1 0 0 0-1.414-1.414L8.5 16.586Z" fill="currentColor"/></svg>',xe='<svg width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="currentColor"/></svg>',Ee=(e="variable-text",t="base")=>`encore-text ${"variable-text"===e?`encore-${e}`:`encore-text-${e}`} ${((e="base")=>`encore-internal-color-text-${e}`)(t)}`,Be=class extends HTMLElement{constructor(e){super(),this.customClass="",this._type="primary",this._isIcon=!1,this._handleClick=()=>{!this.disabled&&this.onChange&&this.onChange()},e&&(this.type=e.type??this.type,this.customClass=e.customClass??this.customClass,this.disabled=e.disabled??this.disabled,this.isIcon=e.isIcon??this._isIcon,this.onChange=e.onChange,e.textContent&&(this.textContent=e.textContent),e.innerHTML&&(this.innerHTML=e.innerHTML),e.ariaLabel&&(this.ariaLabel=e.ariaLabel),e.style&&Object.assign(this.style,e.style)),this.addEventListener("click",this._handleClick)}connectedCallback(){this.classList.add("lucid-button"),this._updateClasses(),this.setAttribute("role","button")}disconnectedCallback(){this.removeEventListener("click",this._handleClick)}_updateClasses(){this.className=`lucid-button ${this.customClass}`,this.classList.toggle("icon",this._isIcon),this.classList.toggle("disabled",this.disabled);for(let e of this.classList)["primary","secondary","tertiary","danger"].includes(e)&&this.classList.remove(e);if(this.classList.add(this.type),this._isIcon&&"icon"===this.type){let e=Ee("body-small-bold");e&&this.classList.add(e)}}set isIcon(e){this._isIcon=e,e?(this.classList.add("icon"),this.setAttribute("is-icon","true")):(this.classList.remove("icon"),this.removeAttribute("is-icon")),this._updateClasses()}get isIcon(){return this._isIcon}set type(e){this._type=e,this.setAttribute("type",e),this._updateClasses()}get type(){return this._type}set disabled(e){e?(this.setAttribute("disabled","true"),this.setAttribute("aria-disabled","true")):(this.removeAttribute("disabled"),this.removeAttribute("aria-disabled")),this._updateClasses()}get disabled(){return this.hasAttribute("disabled")}};customElements.define("custom-button",Be);var Ie=class t extends HTMLElement{constructor(){super(),this._previouslyFocusedElement=null,this._bgElem=e("div",{className:"modal-backdrop"}),this._bgElem.addEventListener("click",(()=>this.close())),this._modalElem=e("div",{className:"modal",role:"dialog",ariaModal:"true"}),this._headerWrapperElem=e("div",{className:"modal-header-container"}),this._headerElem=e("h2",{className:`modal-header ${Ee("title-small")}`,id:"modal-header"});let t=e("div",{className:"modal-header-buttons"});this._closeBtn=this.createIconButton("close","Close Button",'<svg width="24" height="24" fill="none" viewBox="0 0 24 24"><path d="m4.21 4.387.083-.094a1 1 0 0 1 1.32-.083l.094.083L12 10.585l6.293-6.292a1 1 0 1 1 1.414 1.414L13.415 12l6.292 6.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.32.083l-.094-.083L12 13.415l-6.293 6.292a1 1 0 0 1-1.414-1.414L10.585 12 4.293 5.707a1 1 0 0 1-.083-1.32l.083-.094-.083.094Z" fill="currentColor"/></svg>',(()=>this.close())),this._githubBtn=this.createIconButton("github","Github Button",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="24px" height="24px"><path fill="currentColor" d="M15,3C8.373,3,3,8.373,3,15c0,5.623,3.872,10.328,9.092,11.63C12.036,26.468,12,26.28,12,26.047v-2.051 c-0.487,0-1.303,0-1.508,0c-0.821,0-1.551-0.353-1.905-1.009c-0.393-0.729-0.461-1.844-1.435-2.526 c-0.289-0.227-0.069-0.486,0.264-0.451c0.615,0.174,1.125,0.596,1.605,1.222c0.478,0.627,0.703,0.769,1.596,0.769 c0.433,0,1.081-0.025,1.691-0.121c0.328-0.833,0.895-1.6,1.588-1.962c-3.996-0.411-5.903-2.399-5.903-5.098 c0-1.162,0.495-2.286,1.336-3.233C9.053,10.647,8.706,8.73,9.435,8c1.798,0,2.885,1.166,3.146,1.481C13.477,9.174,14.461,9,15.495,9 c1.036,0,2.024,0.174,2.922,0.483C18.675,9.17,19.763,8,21.565,8c0.732,0.731,0.381,2.656,0.102,3.594 c0.836,0.945,1.328,2.066,1.328,3.226c0,2.697-1.904,4.684-5.894,5.097C18.199,20.49,19,22.1,19,23.313v2.734 c0,0.104-0.023,0.179-0.035,0.268C23.641,24.676,27,20.236,27,15C27,8.373,21.627,3,15,3z"/></svg>',(()=>window.open("https://github.com/sanoojes/Spicetify-Lucid"))),this._discordBtn=this.createIconButton("discord","Discord Button",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="24px" height="24px"><path fill="currentColor" d="M25.12,6.946c-2.424-1.948-6.257-2.278-6.419-2.292c-0.256-0.022-0.499,0.123-0.604,0.357 c-0.004,0.008-0.218,0.629-0.425,1.228c2.817,0.493,4.731,1.587,4.833,1.647c0.478,0.278,0.638,0.891,0.359,1.368 C22.679,9.572,22.344,9.75,22,9.75c-0.171,0-0.343-0.043-0.501-0.135C21.471,9.598,18.663,8,15.002,8 C11.34,8,8.531,9.599,8.503,9.615C8.026,9.892,7.414,9.729,7.137,9.251C6.86,8.775,7.021,8.164,7.497,7.886 c0.102-0.06,2.023-1.158,4.848-1.65c-0.218-0.606-0.438-1.217-0.442-1.225c-0.105-0.235-0.348-0.383-0.604-0.357 c-0.162,0.013-3.995,0.343-6.451,2.318C3.564,8.158,1,15.092,1,21.087c0,0.106,0.027,0.209,0.08,0.301 c1.771,3.11,6.599,3.924,7.699,3.959c0.007,0,0.013,0,0.019,0.001c0.194,0,0.377-0.093,0.492-0.25l1.19-1.612 c-2.61-0.629-3.99-1.618-4.073-1.679c-0.444-0.327-0.54-0.953-0.213-1.398c0.326-0.443,0.95-0.541,1.394-0.216 C7.625,20.217,10.172,22,15,22c4.847,0,7.387-1.79,7.412-1.808c0.444-0.322,1.07-0.225,1.395,0.221 c0.324,0.444,0.23,1.066-0.212,1.392c-0.083,0.061-1.456,1.048-4.06,1.677l1.175,1.615c0.115,0.158,0.298,0.25,0.492,0.25 c0.007,0,0.013,0,0.019-0.001c1.101-0.035,5.929-0.849,7.699-3.959c0.053-0.092,0.08-0.195,0.08-0.301 C29,15.092,26.436,8.158,25.12,6.946z M11,19c-1.105,0-2-1.119-2-2.5S9.895,14,11,14s2,1.119,2,2.5S12.105,19,11,19z M19,19 c-1.105,0-2-1.119-2-2.5s0.895-2.5,2-2.5s2,1.119,2,2.5S20.105,19,19,19z"/></svg>',(()=>window.open("https://discord.gg/PWEyKduwJh"))),t.append(this._discordBtn,this._githubBtn,this._closeBtn),this._headerWrapperElem.append(this._headerElem,t),this._modalElem.appendChild(this._headerWrapperElem),this._bodyElem=e("div",{className:"modal-body"}),this._scrollElem=e("div",{className:"modal-scroll"}),this._bodyElem.appendChild(this._scrollElem),this._modalElem.appendChild(this._bodyElem),this.append(this._bgElem,this._modalElem)}static{this.zIndexCounter=1e3}createIconButton(e,t,o,a){let i=new Be;return i.customClass=e,i.ariaLabel=t,i.innerHTML=o.toString(),i.type="icon",i.addEventListener("click",a),i}resetPosition(){this._modalElem.style.transform="translate3d(-50%,-50%,0px)"}get scrollElem(){return this._scrollElem}set isOpen(e){e?this.setAttribute("open","true"):this.removeAttribute("open")}get isOpen(){return!!this.getAttribute("open")}setHeader(e){this._headerElem.innerHTML=e.toString()}open(){this.isOpen=!0,this._previouslyFocusedElement=document.activeElement,this._bgElem.classList.add("modal-backdrop--open"),this._modalElem.classList.add("modal--open"),this._closeBtn.focus(),this.resetPosition(),t.zIndexCounter+=1,this._bgElem.style.zIndex=String(t.zIndexCounter),this._modalElem.style.zIndex=String(t.zIndexCounter),this.dispatchEvent(new Event("open"))}close(){this.isOpen=!1,this._bgElem.classList.remove("modal-backdrop--open"),this._modalElem.classList.remove("modal--open"),this.removeAttribute("open"),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null),this.dispatchEvent(new Event("close"))}setContent(e){this._scrollElem.textContent="","string"==typeof e?this._scrollElem.textContent=e:this._scrollElem.append(e)}};customElements.define("lucid-modal",Ie);var Le=class extends Ie{constructor(){super(),this.dragging=!1,this.startX=0,this.startY=0,this.initialLeft=0,this.initialTop=0,this.setPosition=(e,t)=>{Ce.setState((o=>({isFloating:o.isFloating,position:{top:e,left:t}})))},this.handlePointerDown=e=>{if(!this.isFloating)return;this.dragging=!0,this.startX=e.clientX,this.startY=e.clientY;let t=this._modalElem.getBoundingClientRect();this.initialLeft=t.left,this.initialTop=t.top,this.setAttribute("dragging","true"),document.addEventListener("pointermove",this.handlePointerMove),document.addEventListener("pointerup",this.handlePointerUp)},this.handlePointerMove=e=>{if(!this.dragging)return;let t=e.clientX-this.startX,o=e.clientY-this.startY,a=this.initialLeft+t,i=this.initialTop+o,n=this._modalElem.getBoundingClientRect(),r=n.width,s=n.height;a=Math.max(0,Math.min(a,window.innerWidth-r-16)),i=Math.max(0,Math.min(i,window.innerHeight-s-16)),this._modalElem.style.transform=`translate3d(${a}px,${i}px,0px)`,this.setPosition(i,a)},this.handlePointerUp=e=>{this.dragging=!1,this.removeAttribute("dragging"),document.removeEventListener("pointermove",this.handlePointerMove),document.removeEventListener("pointerup",this.handlePointerUp)},super.setHeader("Lucid Settings")}makeFloating(){let e=Ce.getState().position;e&&void 0!==e.top&&void 0!==e.left&&(this._modalElem.style.transform=`translate3d(${e.left}px,${e.top}px,0px)`),this.setAttribute("floating","true"),this._modalElem.classList.add("modal--floating"),this._bgElem.classList.add("modal-backdrop--floating"),this._headerWrapperElem.addEventListener("pointerdown",this.handlePointerDown)}removeFloating(){this.removeAttribute("floating"),this.resetPosition(),this._bgElem.classList.remove("modal-backdrop--floating"),this._modalElem.classList.remove("modal--floating"),this._headerWrapperElem.removeEventListener("pointerdown",this.handlePointerDown)}set isFloating(e){e?(this.setAttribute("is-floating","true"),this.makeFloating()):(this.removeAttribute("is-floating"),this.removeFloating())}get isFloating(){return!!this.getAttribute("is-floating")}open(){if(super.open(),this.isFloating){let e=Ce.getState().position;e&&void 0!==e.top&&void 0!==e.left&&(this._modalElem.style.transform=`translate3d(${e.left}px,${e.top}px,0px)`)}}};customElements.define("lucid-settings-modal",Le),window.Modal=Ie,window.FloatingModal=Le;var $e=null;function Fe(e,t){$e&&($e instanceof Spicetify.Topbar.Button?$e.element?.remove():$e.deregister(),$e=null),"context-menu"===e?Spicetify?.Menu?.Item?($e=new Spicetify.Menu.Item("Lucid Settings",!1,t,xe)).register():console.error("Context menu unavailable.Try Switching to Nav."):"nav"===e&&(Spicetify?.Topbar?.Button?$e=new Spicetify.Topbar.Button("Lucid Settings",xe,t,!1,!0):console.error("Nav bar unavailable.Try Switching to Context Menu."))}var Pe=null,Te=null,Me=e("div",{id:"tooltip",role:"tooltip",ariaHidden:"true",style:{position:"fixed",display:"block",padding:"0.5rem 1rem",border:"1px solid var(--border-color, var(--clr-surface-0))",color:"var(--clr-on-surface, #fafafa)",backgroundColor:"rgba(var(--clr-surface-0-rgb, var(--spice-rgb-main)), 0.85)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(var(--clr-shadow-rgb), 0.25)",backdropFilter:"blur(10px)",transition:"opacity 0.2s ease-out, transform 0.2s ease-out, visibility 0.2s ease-out",pointerEvents:"auto",zIndex:"1000",opacity:"0",visibility:"hidden",transform:"translateY(-5px) scale(0.95)",maxWidth:window.innerWidth/2+"px",fontSize:"0.875rem",textAlign:"center"}}),Re=e("span",{className:"tooltip-content",style:{display:"inline-block",transition:"opacity 0.3s ease"}});function He(){Me.matches(":hover")||Re.matches(":hover")||(Pe&&(clearTimeout(Pe),Pe=null),Te&&(clearTimeout(Te),Te=null),Te=setTimeout((()=>{Me.style.opacity="0",Me.style.transform="translateY(-5px) scale(0.95)",Me.style.visibility="hidden",Me.setAttribute("aria-hidden","true"),Te=null}),150))}Me.appendChild(Re),document.body.appendChild(Me),Me.addEventListener("mouseenter",(()=>{Te&&(clearTimeout(Te),Te=null)})),Me.addEventListener("mouseleave",(()=>{He()}));var Ae=class{constructor(t){this.open=!1,this.content=t,this.elem=e("div",{className:"tooltip-wrapper",innerHTML:'<span class="icon" style="height:24px; width:24px;"><svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2Zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333 0 4.595 3.738 8.333 8.333 8.333 4.595 0 8.333-3.738 8.333-8.333 0-4.595-3.738-8.333-8.333-8.333ZM12 15.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm0-8.75a2.75 2.75 0 0 1 2.75 2.75c0 1.01-.297 1.574-1.051 2.359l-.169.171c-.622.622-.78.886-.78 1.47a.75.75 0 0 1-1.5 0c0-1.01.297-1.574 1.051-2.359l.169-.171c.622-.622.78-.886.78-1.47a1.25 1.25 0 0 0-2.493-.128l-.007.128a.75.75 0 0 1-1.5 0A2.75 2.75 0 0 1 12 6.75Z" fill="currentColor"/></svg></span>',style:{cursor:"help",display:"inline-flex"},ariaLabel:"string"==typeof t?t:void 0,ariaHasPopup:"true"}),this.mouseoverHandler=e=>{this.open=!0,function(e,t){t&&(Te&&(clearTimeout(Te),Te=null),Pe&&(clearTimeout(Pe),Pe=null),Pe=setTimeout((()=>{let o,a;if("string"==typeof t?Re.innerHTML=`<span style="font-weight: 500; color: inherit;">${t}</span>`:(Re.innerHTML="",Re.appendChild(t)),Me.style.visibility="visible",Me.style.opacity="1",Me.style.transform="translateY(0) scale(1)",Me.setAttribute("aria-hidden","false"),e.target instanceof HTMLElement){let t=e.target.getBoundingClientRect();o=t.left+t.width/2-Me.offsetWidth/2,a=t.top-Me.offsetHeight}else o=e.clientX+10,a=e.clientY+10;o=Math.max(0,Math.min(o,window.innerWidth-Me.offsetWidth)),Me.style.left=`${o}px`,Me.style.top=`${a}px`,Me.style.maxWidth=window.innerWidth/2+"px",Pe=null}),100))}(e,this.content)},this.mouseoutHandler=()=>{!this.elem.matches(":hover")&&this.open&&(He(),this.open=!1)},this.elem.addEventListener("mouseenter",this.mouseoverHandler),this.elem.addEventListener("mouseleave",this.mouseoutHandler)}dispose(){this.elem.removeEventListener("mouseenter",this.mouseoverHandler),this.elem.removeEventListener("mouseleave",this.mouseoutHandler),this.elem.parentNode&&this.elem.parentNode.removeChild(this.elem)}},Oe=class extends HTMLElement{constructor(){super(),this._options=[],this._value="",this._isOpen=!1,this._highlightedIndex=-1,this.shadow=this.attachShadow({mode:"open"}),this.handleDocumentClick=this.handleDocumentClick.bind(this)}set options(e){this._options=e,this.renderOptions()}get options(){return this._options}set value(e){this._value=e,this.updateSelected()}get value(){return this._value}connectedCallback(){this.render(),document.addEventListener("click",this.handleDocumentClick)}disconnectedCallback(){document.removeEventListener("click",this.handleDocumentClick)}render(){this.shadow.innerHTML='\n        <style>.option,.trigger{cursor:pointer;transition:background 225ms ease-in-out}.select-container{width:100%;min-width:6rem;position:relative}.options,.options::before{width:100%;position:absolute}.trigger{padding:.5rem .75rem;background-color:var(--clr-surface-2);width:100%;display:flex;align-items:center;text-align:left;line-height:1px;justify-content:space-between;color:var(--clr-on-surface);border:var(--border-thickness,1px) var(--border-style,solid) var(--border-color,#45454550);border-radius:.5rem}.options{list-style:none;padding:0;margin:0;border:1px solid #ccc;scrollbar-width:thin;background:rgba(var(--clr-surface-1-rgb),.5);z-index:10;max-height:200px;overflow-y:auto;border:var(--border-thickness,1px) var(--border-style,solid) var(--border-color,#45454550);border-radius:.5rem;-webkit-backdrop-filter:blur(8px) saturate(150%);backdrop-filter:blur(8px) saturate(150%)}.options.hidden{display:none}.option{padding:.5rem}.option:last-child{border-bottom:none}.option.highlighted,.option[aria-selected=true]{background:rgba(var(--clr-surface-2-rgb),.7)}.option:hover,.trigger:hover,.trigger[aria-expanded=true]{background:rgba(var(--clr-surface-3-rgb),.75)}.icon{color:var(--clr-on-surface,var(--spice-text));height:20px;width:20px}.trigger,.option{font-size: .85rem;font-weight:500;font-family:inherit;color: var(--clr-on-surface,var(--spice-text,#fafafa))}</style>\n        <div class="select-container">\n          <button type="button" class="trigger" aria-haspopup="listbox" aria-expanded="false">\n            <span class="selected-value"></span>\n            <span class="icon" aria-hidden="true">\n              <svg width="20" height="20" viewBox="0 0 20 20" fill="none">\n                <path d="M5.79681 7C4.95612 7 4.49064 7.97434 5.01887 8.62834L8.83333 13.351C9.43371 14.0943 10.5668 14.0943 11.1672 13.351L14.9816 8.62834C15.5098 7.97434 15.0444 7 14.2037 7H5.79681Z" fill="currentColor"/>\n              </svg>\n            </span>\n          </button>\n          <ul class="options hidden" role="listbox" tabindex="-1"></ul>\n        </div>\n      ',this._trigger=this.shadow.querySelector(".trigger"),this._selectedValueSpan=this.shadow.querySelector(".selected-value"),this._optionsList=this.shadow.querySelector(".options"),this._trigger.addEventListener("click",(()=>this.checkboxOptions())),this._trigger.addEventListener("keydown",(e=>this.handleTriggerKeydown(e))),this._optionsList.addEventListener("click",(e=>this.handleOptionClick(e))),this._optionsList.addEventListener("keydown",(e=>this.handleOptionsKeydown(e))),this.renderOptions(),this.updateSelected()}renderOptions(){if(this._optionsList){this._optionsList.innerHTML="";for(let[t,o]of this._options.entries()){let a=e("li",{role:"option",className:"option",textContent:o.label,ariaSelected:o.value===this._value?"true":"false"});a.setAttribute("data-index",t.toString()),a.setAttribute("data-value",o.value),this._optionsList.appendChild(a)}}}updateSelected(){if(!this._selectedValueSpan)return;let e=this._options.find((e=>e.value===this._value));this._selectedValueSpan.textContent=e?e.label:"Select an option";let t=Array.from(this._optionsList.children);for(let e of t){let t=e.getAttribute("data-value");e.setAttribute("aria-selected",t===this._value?"true":"false")}}checkboxOptions(){this._isOpen=!this._isOpen,this._isOpen?this.openOptions():this.closeOptions()}openOptions(){this._optionsList.classList.remove("hidden"),this._trigger.setAttribute("aria-expanded","true"),this._highlightedIndex=this._options.findIndex((e=>e.value===this._value)),-1===this._highlightedIndex&&(this._highlightedIndex=0),this.highlightOption(this._highlightedIndex),this._optionsList.focus()}closeOptions(){this._isOpen=!1,this._optionsList.classList.add("hidden"),this._trigger.setAttribute("aria-expanded","false"),this._highlightedIndex=-1}handleTriggerKeydown(e){switch(e.key){case"ArrowDown":e.preventDefault(),this.openOptions();break;case"Enter":case" ":e.preventDefault(),this.checkboxOptions()}}handleOptionsKeydown(e){switch(e.key){case"ArrowDown":e.preventDefault(),this.moveHighlight(1);break;case"ArrowUp":e.preventDefault(),this.moveHighlight(-1);break;case"Enter":e.preventDefault(),this.selectHighlighted();break;case"Escape":e.preventDefault(),this.closeOptions(),this._trigger.focus()}}handleOptionClick(e){let t=e.target;if(t&&"option"===t.getAttribute("role")){let e=Number.parseInt(t.getAttribute("data-index")||"0",10);this._highlightedIndex=e,this.selectHighlighted()}}moveHighlight(e){let t=this._options.length;0!==t&&(this._highlightedIndex=(this._highlightedIndex+e+t)%t,this.highlightOption(this._highlightedIndex))}highlightOption(e){let t=this._optionsList.querySelectorAll(".option"),o=0;for(let a of t)o===e?(a.classList.add("highlighted"),a.scrollIntoView({block:"nearest"})):a.classList.remove("highlighted"),o++}selectHighlighted(){if(this._highlightedIndex>=0&&this._highlightedIndex<this._options.length){let e=this._options[this._highlightedIndex];this._value=e.value,this.updateSelected(),this.closeOptions(),this._trigger.focus(),this.dispatchEvent(new Event("change",{bubbles:!0}))}}handleDocumentClick(e){this.contains(e.target)||this.closeOptions()}};customElements.define("accessible-select",Oe);var Ne=class extends HTMLElement{constructor(){super(...arguments),this._renderedOptions=null,this._inputElement=null,this._previewElement=null}set inputOptions(e){this._inputOptions=e,this.render()}get inputOptions(){return this._inputOptions}connectedCallback(){this.render()}removeContent(){this._inputElement=null,this._previewElement=null,this.innerHTML=""}render(){if(this._renderedOptions&&function(e,t){if(e===t)return!0;let o=Object.keys(e),a=Object.keys(t);if(o.length!==a.length)return!1;for(let a of o)if(e[a]!==t[a])return!1;return!0}(this._renderedOptions,this._inputOptions))return;this.removeContent();let t=(e,t,o)=>{let a=this._inputElement,i=a.value,n=o?o(i):i;if(!e)return void t?.(n);let r=e(n);r.isValid?(a.classList.remove("error","shake-error"),t?.(n)):(a.classList.remove("shake-error"),a.offsetWidth,a.classList.add("error","shake-error"),r.message&&f(r.message,!0,2e3))};switch(this._inputOptions.type){case"button":{let{buttonType:e,onClick:t,contents:o}=this._inputOptions;this._inputElement=new Be,this._inputElement.type=e||"primary",t&&(this._inputElement.onclick=t),this._inputElement.innerHTML=o?.toString()||"Button",this.append(this._inputElement);break}case"number":{let{type:o,step:a,value:i,onChange:n,validator:r}=this._inputOptions;this._inputElement=e("input",{type:o,step:a?.toString()||"1",value:i?.toString(),className:"input number"});let s=new Be;s.innerHTML=_e,s.type="icon",s.onclick=()=>t(r,n,(e=>Number.parseFloat(e))),this.append(this._inputElement,s);break}case"text":{let{type:o,value:a,onChange:i,validator:n}=this._inputOptions;this._inputElement=e("input",{type:o,value:a,className:"input text"});let r=new Be;r.innerHTML=_e,r.type="icon",r.onclick=()=>t(n,i),this.append(this._inputElement,r);break}case"checkbox":{let{onChange:t,checked:o,type:a}=this._inputOptions;this._inputElement=e("input",{checked:o,type:a,className:"checkbox custom"}),this._inputElement.onchange=e=>t?.(e.target.checked),this.append(this._inputElement);break}case"select":{let{options:e,value:t,onChange:o}=this._inputOptions;this._inputElement=new Oe,e&&(this._inputElement.options=e),t&&(this._inputElement.value=t),this._inputElement.onchange=e=>o?.(e.target.value),this.append(this._inputElement);break}case"color":{let{value:o,onChange:a}=this._inputOptions;this._inputElement=e("input",{type:"color",value:o,className:"input color"});let i=new Be;i.innerHTML='<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.03 2.97a3.578 3.578 0 0 0-5.06 0L14 4.94l-.013-.013a1.75 1.75 0 0 0-2.475 0l-.585.586a1.75 1.75 0 0 0 0 2.474l.012.013-6.78 6.78a2.25 2.25 0 0 0-.659 1.591v.688l-1.28 2.347c-.836 1.533.841 3.21 2.374 2.374l2.347-1.28h.688a2.25 2.25 0 0 0 1.59-.659L16 13.061l.012.012a1.75 1.75 0 0 0 2.475 0l.586-.585a1.75 1.75 0 0 0 0-2.475L19.061 10l1.97-1.97a3.578 3.578 0 0 0 0-5.06ZM12 9.06 14.94 12l-6.78 6.78a.75.75 0 0 1-.531.22H6.75a.75.75 0 0 0-.359.092l-2.515 1.372a.234.234 0 0 1-.159.032.264.264 0 0 1-.138-.075.264.264 0 0 1-.075-.138.234.234 0 0 1 .033-.159l1.372-2.515A.75.75 0 0 0 5 17.25v-.879a.75.75 0 0 1 .22-.53L12 9.061Z" fill="currentColor"/></svg>',i.type="icon",i.onclick=async()=>{if("EyeDropper"in window||!window.EyeDropper)try{if(!window.EyeDropper)return;let e=(await(new window.EyeDropper).open()).sRGBHex;this._inputElement.value=e,a?.(e)}catch(e){e instanceof Error&&"No color selected"!==e.message&&(console.error("EyeDropper Error:",e),f("Failed to pick color with EyeDropper.",!0,3e3))}else f("EyeDropper API is not supported in this browser.",!0,3e3)};let n=new Be;n.innerHTML=_e,n.type="icon",n.onclick=()=>{t((()=>({isValid:!0})),a)},window.EyeDropper?this.append(this._inputElement,i,n):this.append(this._inputElement,n);break}case"image":{let{onChange:t}=this._inputOptions;this._inputElement=e("input",{type:"file",accept:"image/*",className:"input image",style:{display:"none",visibility:"hidden"}}),this._previewElement=e("img",{className:"image-preview",style:{borderRadius:"0.5rem"}}),this._previewElement.src="",this.prepend(this._previewElement),this._inputElement.onchange=e=>{let o=e.target.files?.[0];if(o){let e=new FileReader;e.onload=e=>{let o=e.target?.result;t?.(o),this._previewElement&&(this._previewElement.src=o)},e.readAsDataURL(o)}else t?.(null),this._previewElement&&(this._previewElement.src="")},this.append(new Be({type:"primary",textContent:"Select Image",onChange:()=>{this._inputElement?.click()}}),this._inputElement);break}default:console.error("Unsupported input options:",this._inputOptions)}this._renderedOptions=this._inputOptions}};customElements.define("custom-input",Ne);var Ue=class extends HTMLElement{constructor(){super(...arguments),this._isRender=!1,this.rendered=!1,this._settings=[],this.sectionElements=[]}connectedCallback(){!this.sectionElements.length&&this._settings.length&&this.createSectionElements(),this.render(),this.updateVisibility()}set options(e){this._settings=e,this.updateSectionElements(),this.render(),this.updateVisibility()}set isRender(e){this._isRender=e,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML=""}createSectionElements(){this.sectionElements=[];for(let e of this._settings){let t=new Ve;t.options=e,this.sectionElements.push(t)}}updateSectionElements(){let e=new Map;for(let t of this.sectionElements){let o=t._name;e.set(o,t)}let t=[];for(let o of this._settings){let a=o.name,i=e.get(a);i||(i=new Ve),i.options=o,t.push(i)}this.sectionElements=t}render(){!this._settings||0===this._settings.length||this.rendered||(this.clear(),this.append(...this.sectionElements),this.rendered=!0)}};customElements.define("settings-main",Ue);var Ve=class extends HTMLElement{constructor(){super(),this._isRender=!1,this.rendered=!1,this._name="",this._groups=[],this.groupElements=[],this._headerElement=e("div",{className:"header-wrapper",style:{textAlign:"center"}}),this._groupsWrapperElement=e("div",{style:{marginTop:".25rem",display:"flex",flexDirection:"column",gap:".5rem",width:"100%"}})}connectedCallback(){!this.groupElements.length&&this._groups.length&&this.createGroupElements(),this.render(),this.updateVisibility()}set options(e){this._name=e.name,this._groups=e.groups,this._isRender=e.render,this.updateGroupElements(),this.render(),this.updateVisibility()}set isRender(e){this._isRender=e,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="block",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML="",this._headerElement.innerHTML="",this._groupsWrapperElement.innerHTML=""}createGroupElements(){this.groupElements=[];for(let e of this._groups){let t=new De;t.options=e,this.groupElements.push(t)}}updateGroupElements(){let e=new Map;for(let t of this.groupElements)e.set(t._key,t);let t=[];for(let o of this._groups){let a=e.get(o.key);a||(a=new De),a.options=o,t.push(a)}this.groupElements=t}render(){!this._groups||0===this._groups.length||this.rendered||(this.dataset.tabId=this._name.toLowerCase(),this.clear(),this._headerElement.append(e("h3",{textContent:this._name,className:Ee("title-small"),style:{fontSize:"1.25rem"}})),this._groupsWrapperElement.append(...this.groupElements),this.append(this._headerElement,this._groupsWrapperElement),this.rendered=!0)}};customElements.define("setting-section",Ve);var De=class extends HTMLElement{constructor(){super(),this._isRender=!1,this.rendered=!1,this._showName=!0,this._name="Section",this._fields=[],this._key="",this.fieldElements=[],this._nameContainerElement=e("div"),this._fieldsContainerElement=e("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}})}connectedCallback(){!this.fieldElements.length&&this._fields.length&&this.createFieldElements(),this.render(),this.updateVisibility()}set options(e){this._name=e.name,this._fields=e.fields,this._isRender=e.render,this._key=e.key,this._showName=e.showName??!0,this.updateFieldElements(),this.updateVisibility()}set isRender(e){this._isRender=e,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML="",this._nameContainerElement.innerHTML="",this._fieldsContainerElement.innerHTML=""}createFieldElements(){this.fieldElements=[];for(let e of this._fields){let t=new ze;t.isRender=e.render??!0,t.inputOptions=e.inputOptions,t.label=e.label,t.fieldKey=e.key,e.tooltip&&(t.tooltip=e.tooltip),this.fieldElements.push(t)}}updateFieldElements(){let e=new Map;for(let t of this.fieldElements)e.set(t.fieldKey,t);let t=[];for(let o of this._fields){let a=e.get(o.key);a?(a.isRender=o.render??!0,a.inputOptions=o.inputOptions,o.tooltip&&(a.tooltip=o.tooltip)):(a=new ze,a.isRender=o.render??!0,a.inputOptions=o.inputOptions,a.label=o.label,a.fieldKey=o.key,o.tooltip&&(a.tooltip=o.tooltip)),t.push(a)}this.fieldElements=t}render(){!this._fields||0===this._fields.length||this.rendered||(this.dataset.groupId=this._name.toLowerCase(),this.clear(),this._name&&this._showName&&(this._nameContainerElement.append(e("h4",{textContent:this._name,className:Ee("body-small-bold"),style:{fontSize:".8rem",marginLeft:".25rem",lineHeight:"normal"}})),this.append(this._nameContainerElement)),this._fieldsContainerElement.append(...this.fieldElements),this.append(this._fieldsContainerElement),this.rendered=!0)}};customElements.define("setting-group",De);var ze=class extends HTMLElement{constructor(){super(),this._fieldKey="",this._isRender=!1,this.rendered=!1,this._label="Section",this._tooltipInstance=null,this.inputOptions=null,this._inputElement=new Ne,this._labelContainer=e("div",{className:"label-wrapper",style:{display:"flex",gap:"0.5rem",alignItems:"center"}})}connectedCallback(){this.rendered||this.render(),this.updateVisibility()}disconnectedCallback(){this._tooltipInstance?.dispose()}set isRender(e){this._isRender=e,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}set tooltip(e){e&&(this._tooltipInstance||(this._tooltipInstance=new Ae(e)),this._tooltipInstance.content=e)}clear(){this.innerHTML=""}render(){!this.inputOptions||this.rendered||(this.dataset.fieldId=this._label.toLowerCase(),this._labelContainer.append(e("p",{textContent:this._label,className:Ee("body-small")})),this._tooltipInstance&&this._labelContainer.append(this._tooltipInstance.elem),this._inputElement.inputOptions=this.inputOptions,this.append(this._labelContainer,this._inputElement),this.rendered=!0)}set label(e){this._label=e,this.rendered&&this.render()}get label(){return this._label}set fieldKey(e){this._fieldKey=e}get fieldKey(){return this._fieldKey}};customElements.define("setting-field",ze);var Ge=e=>{let t="Invalid URL";try{let o=new URL(e);return["http:","https:"].includes(o.protocol)?{isValid:!0}:{isValid:!1,message:t}}catch{return{isValid:!1,message:t}}},We=(e,t,o)=>{let a=`Enter a number between ${t} and ${o}.`;return"number"!=typeof e||Number.isNaN(e)||e<t||e>o?{isValid:!1,message:a}:{isValid:!0}},qe=e=>We(e,0,512),je=e=>We(e,0,256),Ke=e=>We(e,0,200),Ze=e=>We(e,0,100),Xe=e=>We(e,0,10),Je=e=>{if(!e||""===e.trim())return{isValid:!1,message:"URL cannot be empty."};try{let t=new URL(e);return t.hostname.endsWith("fonts.googleapis.com")||t.hostname.endsWith("fonts.gstatic.com")?"http:"!==t.protocol&&"https:"!==t.protocol?{isValid:!1,message:"Protocol must be HTTP or HTTPS."}:t.pathname.startsWith("/css")||t.pathname.startsWith("/earlyaccess")||t.hostname.endsWith("fonts.gstatic.com")?t.hostname.endsWith("fonts.googleapis.com")&&!t.searchParams.has("family")?{isValid:!1,message:"URL does not contain the 'family' parameter."}:{isValid:!0}:{isValid:!1,message:"Path is not a typical Google Fonts CSS path."}:{isValid:!1,message:"Hostname is not a Google Fonts domain."}}catch{return{isValid:!1,message:"Invalid URL format."}}};var Ye=null,Qe=()=>new Promise(((e,t)=>{if(Ye)return console.debug("Lucid: Database already initialized."),void e();let o=window.indexedDB.open("LucidImageDB",1);o.onerror=e=>{console.error("Database error:",e),t(e)},o.onsuccess=()=>{Ye=o.result,console.debug("Lucid: Database initialized."),e()},o.onupgradeneeded=()=>{Ye=o.result,console.debug("Lucid: Upgrading database..."),Ye.objectStoreNames.contains("imageStore")||Ye.createObjectStore("imageStore",{keyPath:"id"}).createIndex("data","data",{unique:!1})}}));function et(e){let t="";return void 0!==e?.blur&&(t+=`blur(${e.blur}px) `),void 0!==e?.brightness&&(t+=`brightness(${e.brightness}%) `),void 0!==e?.contrast&&(t+=`contrast(${e.contrast}%) `),void 0!==e?.grayscale&&(t+=`grayscale(${e.grayscale}) `),void 0!==e?.hueRotate&&(t+=`hue-rotate(${e.hueRotate}) `),void 0!==e?.invert&&(t+=`invert(${e.invert}) `),void 0!==e?.opacity&&(t+=`opacity(${e.opacity}%) `),void 0!==e?.saturate&&(t+=`saturate(${e.saturate||0}%) `),void 0!==e?.sepia&&(t+=`sepia(${e.sepia}) `),t.trim()}var tt=document.querySelector("lucid-bg-wrapper"),ot=tt?.querySelector("lucid-bg"),at=null,it=null,nt=null,rt=(t=G.getState())=>{let o=t.background;switch(o.mode){case"solid":{it||(at=null,nt=null,ot||st(),!it&&ot&&(it=e("div",{className:"solid-bg",style:{backgroundColor:"var(--solid-bg-color, var(--clr-surface))",height:"100%",width:"100%"}}),ot.innerHTML="",ot.appendChild(it)));let{hex:t,alpha:a}=o.options.solid.color;it?.style.setProperty("--solid-bg-color",`${t}${be(a)}`);break}case"static":{if(at||(it=null,nt=null,ot||st(),!at&&ot&&(at=e("img",{className:"static-bg",style:{display:"block",height:"100%",width:"100%",objectFit:"cover",filter:"var(--static-bg-filter)"}}),ot.innerHTML="",ot.appendChild(at))),!at)return;let{filter:t,isCustomImage:a}=o.options.static;a?at.setAttribute("custom-image",""):at.removeAttribute("custom-image"),at.style.setProperty("--static-bg-filter",et(t)),lt();break}case"animated":{if(nt||(()=>{if(at=null,it=null,ot||st(),!nt&&ot){nt=e("div",{className:"animated-bg-wrapper",style:{position:"relative",height:"100%",width:"100%"}}),ot.innerHTML="\n<style>\n.img{ position: absolute; border-radius: 20em; width: 200%; animation: animBg var(--anim-bg-time,60s) linear infinite;}\n.img-0 { right: 30%; top: 0; z-index: 2 }\n.img-1 { animation-direction: reverse; bottom: 0; left: 0; z-index: 1}\n.img-2 { animation-direction: reverse; right: -50%; top: -20%; width: 300%; z-index: 0 }\n@keyframes animBg { 0% { transform: rotate(0deg) translate3d(0px,0px,0px); } to { transform: rotate(1turn) translate3d(0px,0px,0px); } }\n</style>\n";for(let t=0;t<3;t++){let o=e("img",{className:`img img-${t}`,style:{willChange:"transform",backgroundImage:"url(var(--image-url))"}});nt.appendChild(o)}ot.appendChild(nt)}})(),!nt)return;let{filter:t,time:a}=o.options.animated;nt.style.filter=et(t),nt.style.setProperty("--anim-bg-time",`${a}s`),lt();break}default:console.error("Unexpected background mode:",o.mode),f("Unexpected error setting background.")}},st=()=>{tt||(tt=e("div",{className:"lucid-bg-wrapper",style:{display:"block",position:"fixed",height:"100vh",width:"100vw",zIndex:"-1",top:"0",left:"0",overflow:"hidden"}}),(document.getElementById("main")??document.body).prepend(tt)),ot||(ot=e("div",{className:"lucid-bg",style:{display:"block",height:"100%",width:"100%",overflow:"hidden"}}),tt.prepend(ot))},lt=async()=>{let e=G.getState();if("solid"===e.background.mode)return;let t="";t=e.background.options.static.isCustomImage?"local"===e.customImage.type?await new Promise(((e,t)=>{let o=()=>{if(!Ye)return;let o=Ye.transaction(["imageStore"],"readonly").objectStore("imageStore").get(1);o.onsuccess=()=>{let t=o.result;e(t?t.data:null)},o.onerror=e=>{console.error("Error retrieving image",e),t(e)}};Ye?o():Qe().then(o).catch(t)})):e.customImage.options.url.data:Y.getState().url,(e=>{if(ot&&e){let t=new Image;t.src=e,t.onload=()=>{if(ot||st(),at&&(at.src=e??""),nt){let t=nt.querySelectorAll("img");for(let o of t)o.src=e??""}}}})(t??"")};var ct=class extends HTMLElement{constructor(){super(),this.steps=[],this.currentStepIndex=0,this.interactiveElements=[],b("guided-tour-styles").textContent='\nbody, #main { overflow: hidden; } \n.hidden, .tour-container.arrow-hidden:before { display: none; }\n.tour-container {position: absolute;background-color: var(--clr-surface-2);padding: 1rem;border-radius: .5rem;max-width: 30em;box-shadow: 0 0 2rem rgba(0, 0, 0, 0.5);z-index: 99999;opacity: 0;visibility: hidden;transform: translate3d(0, -10px, 0);transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out, transform 0.3s ease-in-out;}\n.tour-container.full-width { width: 100%; max-width: 100% }\n.tour-container.visible:before {content: "";position: absolute;height: 1.5rem;width: 1.5rem;border-radius: 6px;top: 0;left: 50%;background-color: var(--clr-surface-2);clip-path: polygon(0 0, 0% 100%, 100% 0);transform: rotate(45deg) translate(-50%, 0);z-index: -1;}\n.tour-container.visible { opacity: 1; visibility: visible; transform: translate3d(0, 0, 0) }\n.tour-btn {border: var(--border-thickness, 1px) var(--border-style, solid) var(--border-color, rgba(var(--clr-surface-5-rgb), 0.25));background-color: var(--clr-tertiary);color: var(--clr-on-tertiary);padding: .5rem 1rem;border-radius: .3rem;font-weight: 500;cursor: pointer;transition: background-color 225ms ease-in-out;}\n.tour-btn:hover { background-color: var(--clr-on-tertiary); color: var(--clr-tertiary) }\n.tour-btn.skip-btn { background-color: var(--clr-secondary); color: var(--clr-on-secondary) }\n.tour-btn.skip-btn:hover { background-color: var(--clr-on-secondary); color: var(--clr-secondary) }\n.tour-btn.prev-btn { background-color: var(--clr-primary); color: var(--clr-on-primary) }\n.tour-btn.prev-btn:hover { background-color: var(--clr-on-primary); color: var(--clr-primary) }\n.tour-button-wrapper { display: flex; justify-content: space-between; margin-top: 1rem; gap: .5rem; }\n.tour-step-counter { margin-bottom: 0.5rem; text-align: center; font-weight: bold; color: var(--clr-on-surface); }\n.tour-navigation-wrapper { display: flex; gap: 0.5rem; }\n.tour-navigation-wrapper .next-btn { margin-left: 0.5rem; }\n'}connectedCallback(){this.style.position="fixed",this.style.inset="0px",this.style.pointerEvents="none"}set tourSteps(e){this.steps=e}get tourSteps(){return this.steps}start(){this.steps.length>0&&this.steps[0].onStart&&this.steps[0].onStart(),this.currentStepIndex=0,this.renderTooltip(),this.showStep()}renderTooltip(){if(!this.tooltip){this.tooltip=e("div",{className:"tour-container",role:"dialog",ariaModal:"true"}),this.stepCounter=e("div",{className:"tour-step-counter"}),this.message=e("div",{className:`tour-message ${Ee("body-medium")}`}),this.skipButton=this.createButton("skip-btn","Skip Tour",this.endTour.bind(this)),this.prevButton=this.createButton("prev-btn hidden","Previous",this.prevStep.bind(this)),this.nextButton=this.createButton("next-btn","Next",this.nextStep.bind(this));let t=e("div",{className:"tour-button-wrapper"}),o=e("div",{className:"tour-navigation-wrapper"});o.append(this.prevButton,this.nextButton),t.append(o),t.prepend(this.skipButton),this.tooltip.append(this.stepCounter,this.message,t),this.appendChild(this.tooltip)}}createButton(t,o,a){let i=e("button",{className:`tour-btn ${t}`,textContent:o});return i.onclick=a,i}async showStep(e=!1){if(this.currentStepIndex>=this.steps.length)return void this.endTour();let t=this.steps[this.currentStepIndex];return this.targetElement=document.querySelector(t.target),this.targetElement&&null!==this.targetElement.offsetParent?this.targetElement?(this.targetElement.scrollIntoView({behavior:"smooth",block:"center"}),await new Promise((e=>setTimeout(e,t.wait??500))),this.disablePointerEvents(),this.enablePointerEventsForInteractiveElements(t),void this.updateTooltip(t)):(console.warn(`Target element not found: ${t.target}. Skipping step.`),e?this.currentStepIndex--:this.currentStepIndex++,void this.showStep(e)):(console.warn(`Skipping invisible or missing target: ${t.target}`),e?this.currentStepIndex--:this.currentStepIndex++,void this.showStep(e))}updateTooltip(e){if(!this.tooltip||!this.targetElement)return;this.tooltip.classList.toggle("arrow-hidden",!(e.arrow??1)),this.stepCounter.textContent=`Step ${this.currentStepIndex+1} of ${this.steps.length}`,this.message.textContent=e.content,this.prevButton.classList.toggle("hidden",0===this.currentStepIndex),this.nextButton.textContent=this.currentStepIndex===this.steps.length-1?"End Tour":"Next";let t=this.targetElement.getBoundingClientRect(),o=this.tooltip.getBoundingClientRect(),a=0,i=0;switch(e.position||"center"){case"top right":a=t.top-o.height-16,i=t.right-o.width-32;break;case"top left":a=t.top-o.height-16,i=t.left-32;break;case"bottom left":a=t.bottom+16,i=t.left-32;break;case"bottom right":a=t.bottom+16,i=t.right-o.width-32;break;default:a=t.top+t.height+16,i=t.left+t.width/2-o.width/2,a+o.height>window.innerHeight&&(a=t.top-o.height-16)}i<0?i=10:i+o.width>window.innerWidth&&(i=window.innerWidth-o.width-10),a<0?a=10:a+o.height>window.innerHeight&&(a=window.innerHeight-o.height-10),this.tooltip.style.transform=`translate3d(${i}px, ${a}px, 0)`,this.tooltip.classList.add("visible")}nextStep(){this.steps[this.currentStepIndex].onComplete&&this.steps[this.currentStepIndex].onComplete?.(),this.currentStepIndex++,this.showStep()}prevStep(){this.currentStepIndex>0?(this.steps[this.currentStepIndex-1]?.onPrevious&&this.steps[this.currentStepIndex-1].onPrevious?.(),this.currentStepIndex--,this.showStep(!0)):console.warn("Already at the first step, cannot go back.")}disablePointerEvents(){document.body.style.pointerEvents="none"}enablePointerEventsForInteractiveElements(e){if(this.tooltip&&this.targetElement){if(this.interactiveElements=[this.targetElement,this.tooltip],e.interactiveElementsSelector){let t=document.querySelectorAll(e.interactiveElementsSelector);for(let e of t)this.interactiveElements.push(e)}for(let e of this.interactiveElements)e.style.pointerEvents="auto"}}resetPointerEvents(){document.body.style.pointerEvents="auto";for(let e of this.interactiveElements)e.style.pointerEvents="auto";this.interactiveElements=[]}endTour(){console.debug("Tour skipped or ended."),this.resetPointerEvents(),this.tooltip&&(this.tooltip.classList.remove("visible"),this.tooltip.addEventListener("transitionend",(()=>{this.tooltip&&(this.tooltip.parentElement?.removeChild(this.tooltip),this.tooltip=void 0)}),{once:!0}))}};customElements.define("guided-tour",ct);var dt=(t,o)=>e("button",{className:`lucid-button ${Ee("body-small-bold")} ${t}`,textContent:o}).outerHTML,pt=()=>{window?.lucid?.settings?.openSettings?.()},ut={navBtn:"Click here to open settings.",ctxMenu:"Settings open button is in this context menu. Click to open it.",ctxMenuItem:"Click here to open settings.",welcomeModal:"Welcome to Lucid Settings! Here you can customize every aspect of your theme.",genTab:'Let\'s start in the "General" tab to customize basic settings.',floatWin:'First, let\'s look at "Floating Window" setting. Control if the settings window floats or stays embedded.',winPos:'Next, "Window Position". Choose where you want the settings to open - Navigation bar or Context menu.',intfTab:'Now, we are moving to the "Interface" tab to customize page and sidebar styles.',bgStyle:'In "Interface", find "Background Style". Here you can change the overall style of pages background.',npViewGrp:'Still in "Interface", let\'s customize "Now Playing View" sidebar.',npViewMode:'Within "Now Playing View" settings, you can switch between "Normal" and "Compact" view modes for the sidebar.',bgTab:'Next, we will check "Background" tab to explore the theme background options.',bgMode:"Here you can change the background mode. Try switching between Animated, Solid Color, and Static Image to see different background types.",dynColor:"Checkout new Dynamic Color. This feature automatically adapts your theme’s colors to match the album art of the song that's playing. Try switching songs to see the effect in action!",gFontsGrp:'In "Interface" tab, Here you can enable "Google Fonts" to unlock a vast library of fonts for your theme.',borderGrp:'Still in "Interface" tab, here, you can change the look and style of the application border.',playbarTab:'Let\'s move to the "Playbar Settings" tab to customize the playbar at the bottom.',playbarType:'Try changing the "Playbar Type" between "Default" and "Compact" to see how it changes the layout.',advTab:'Finally, explore "Advanced Settings" tab for more control over the theme behavior.',closeModal:"That's all for the essential settings tour! Explore other options to fully customize Lucid. Click here to close settings."};var ht=null,gt=null,mt=()=>{gt&&(localStorage.setItem(i,"true"),gt.start(),yt(),document.body.appendChild(gt))},bt=()=>{gt&&(localStorage.setItem(i,"true"),gt.endTour(),yt(),window?.lucid?.settings?.settingModal?.removeEventListener("close",pt))},ft=()=>{(ht=new Ie).setHeader("Welcome to Lucid Theme!"),ht.setContent((()=>{let t=e("div",{className:"tour-container arrow-hidden visible full-width",style:{position:"relative"},innerHTML:`<div class="tour-arrow"></div><div class="tour-message ${Ee("body-medium")}">Ready to explore lucid theme with a quick guided tour?</div><div class="tour-button-wrapper">${dt("skip-btn tour-btn","Skip Tour")}${dt("start-tour-btn tour-btn","Start Tour")}</div>`}),o=t.querySelector(".start-tour-btn"),a=t.querySelector(".skip-btn");return o.addEventListener("click",mt),a.addEventListener("click",bt),t})())},yt=()=>{ht&&(ht.close(),ht=null)},vt=()=>{try{if("true"===localStorage.getItem(i))return;localStorage.setItem(i,"true"),gt=new ct;let e=e=>{gt&&(gt.tourSteps=function(e=G.getState()){function t(){Ct(),window?.lucid?.settings?.settingModal?.addEventListener("close",pt,{once:!0})}return[..."nav"===e.position?[{target:"button[aria-label='Lucid Settings']",content:ut.navBtn,onComplete:t,interactiveElementsSelector:"button[aria-label='Lucid Settings']"}]:[{target:".main-userWidget-box",content:ut.ctxMenu,onComplete:()=>{document.querySelector(".main-userWidget-box")?.click()},interactiveElementsSelector:".main-userWidget-box"},{target:".main-userWidget-dropDownMenu .main-contextMenu-menuItem:nth-child(3)",content:ut.ctxMenuItem,wait:500,onComplete:t,interactiveElementsSelector:".main-userWidget-dropDownMenu .main-contextMenu-menuItem:nth-child(3)"}],{target:"lucid-settings-modal .modal-header-container",content:ut.welcomeModal,arrow:!1,interactiveElementsSelector:".modal-header-container"},{target:'setting-section[data-tab-id="general"] .header-wrapper',content:ut.genTab,arrow:!0,wait:700,interactiveElementsSelector:'setting-section[data-tab-id="general"] .header-wrapper'},{target:'setting-field[data-field-id="floating window"] .label-wrapper',content:ut.floatWin,arrow:!0,interactiveElementsSelector:'setting-field[data-field-id="floating window"]',onStart:()=>{Ce.setState((e=>({...e,isFloating:!0})))}},{target:'setting-field[data-field-id="window position"] .label-wrapper',content:ut.winPos,arrow:!0,interactiveElementsSelector:'setting-field[data-field-id="window position"]'},{target:'setting-section[data-tab-id="interface"] .header-wrapper',content:ut.intfTab,arrow:!0,interactiveElementsSelector:'setting-section[data-tab-id="interface"] .header-wrapper',onStart:()=>{document.querySelector('setting-section[data-tab-id="interface"] .header-wrapper')?.scrollIntoView({behavior:"smooth",block:"center"})},wait:500},{target:'setting-section[data-tab-id="interface"] setting-field[data-field-id="background style"] .label-wrapper',content:ut.bgStyle,arrow:!0,interactiveElementsSelector:'setting-section[data-tab-id="interface"] setting-field[data-field-id="background style"]',onStart:()=>{document.querySelector('setting-section[data-tab-id="interface"] setting-field[data-field-id="background style"] .label-wrapper')?.scrollIntoView({behavior:"smooth",block:"center"})},wait:500},{target:'setting-section[data-tab-id="interface"] setting-group[data-group-id="now playing view"] .header-wrapper',content:ut.npViewGrp,arrow:!0,interactiveElementsSelector:'setting-section[data-tab-id="interface"] setting-group[data-group-id="now playing view"] .header-wrapper',onStart:()=>{document.querySelector('setting-section[data-tab-id="interface"] setting-group[data-group-id="now playing view"] .header-wrapper')?.scrollIntoView({behavior:"smooth",block:"center"})},wait:500},{target:'setting-section[data-tab-id="interface"] setting-group[data-group-id="now playing view"] setting-field[data-field-id="view mode"] .label-wrapper',content:ut.npViewMode,arrow:!0,interactiveElementsSelector:'setting-section[data-tab-id="interface"] setting-group[data-group-id="now playing view"] setting-field[data-field-id="view mode"]',onStart:()=>{document.querySelector('setting-section[data-tab-id="interface"] setting-group[data-group-id="now playing view"] setting-field[data-field-id="view mode"] .label-wrapper')?.scrollIntoView({behavior:"smooth",block:"center"})},wait:500},{target:'setting-section[data-tab-id="background"] .header-wrapper',content:ut.bgTab,arrow:!0,wait:700,interactiveElementsSelector:'setting-section[data-tab-id="background"] .header-wrapper'},{target:'setting-section[data-tab-id="background"] setting-field[data-field-id="background mode"]',content:ut.bgMode,arrow:!0,wait:700,position:"bottom left",interactiveElementsSelector:'setting-section[data-tab-id="background"] setting-field[data-field-id="background mode"]'},{target:'setting-section[data-tab-id="background"] setting-field[data-field-id="dynamic color"]',content:ut.dynColor,arrow:!0,wait:700,interactiveElementsSelector:'setting-section[data-tab-id="background"] setting-field[data-field-id="dynamic color"]'},{target:'setting-section[data-tab-id="interface"] setting-group[data-group-id="font"]',content:ut.gFontsGrp,arrow:!0,wait:700,interactiveElementsSelector:'setting-section[data-tab-id="interface"] setting-field[data-field-id="google fonts"]',onStart:()=>{document.querySelector('setting-section[data-tab-id="interface"] setting-group[data-group-id="font"]')?.scrollIntoView({behavior:"smooth",block:"center"})}},{target:'setting-section[data-tab-id="interface"] setting-group[data-group-id="border"]',content:ut.borderGrp,arrow:!0,wait:700,interactiveElementsSelector:'setting-section[data-tab-id="interface"] setting-field[data-field-id="style"]',onStart:()=>{document.querySelector('setting-group[data-group-id="border"]')?.scrollIntoView({behavior:"smooth",block:"center"})}},{target:'setting-section[data-tab-id="playbar settings"] .header-wrapper',content:ut.playbarTab,arrow:!0,wait:700,interactiveElementsSelector:'setting-section[data-tab-id="playbar settings"] .header-wrapper',onStart:()=>{document.querySelector('setting-section[data-tab-id="playbar settings"] .header-wrapper')?.scrollIntoView({behavior:"smooth",block:"center"})}},{target:'setting-section[data-tab-id="playbar settings"] setting-field[data-field-id="playbar type"]',content:ut.playbarType,arrow:!0,wait:700,interactiveElementsSelector:'setting-section[data-tab-id="playbar settings"] setting-field[data-field-id="playbar type"]',onStart:()=>{document.querySelector('setting-field[data-field-id="playbar type"]')?.scrollIntoView({behavior:"smooth",block:"center"})}},{target:'setting-section[data-tab-id="advanced settings"] .header-wrapper',content:ut.advTab,arrow:!0,interactiveElementsSelector:'setting-section[data-tab-id="advanced settings"] .header-wrapper',onStart:()=>{document.querySelector('setting-section[data-tab-id="advanced settings"] .header-wrapper')?.scrollIntoView({behavior:"smooth",block:"center"})},wait:500},{target:"lucid-settings-modal custom-button.close",content:ut.closeModal,arrow:!0,onComplete:()=>{window?.lucid?.settings?.settingModal?.removeEventListener("close",pt),window.dispatchEvent(new CustomEvent("remove-tour"))},interactiveElementsSelector:"lucid-settings-modal"}]}(e))};e(),G.subscribe(e,"position"),ft(),ht&&((document.getElementById("main")??document.body)?.appendChild(ht),ht.open())}catch(e){console.error("Error in tour: ",e)}},wt=null,St=null,kt=new Le,Ct=()=>{wt?.()},_t=()=>{St?.()};function xt(){kt.isFloating=Ce.getState().isFloating,kt.setContent((()=>{let t=e("div",{id:"settings-container"}),o=new Ue;return o.isRender=!0,o.options=Bt(),G.subscribe((e=>{o.options=Bt(e)})),t.appendChild(o),t})()),Ce.subscribe((e=>{kt.isFloating=e.isFloating}),"isFloating"),document.getElementById("main")?.append(kt),wt=()=>kt.open(),St=()=>kt.close(),Fe(G.getState().position,Ct),G.subscribe((e=>{Fe(e.position,Ct)}),"position")}var Et={floatWin:["Floating Window","Allows settings to float. Drag header to reposition."],winPos:["Window Position","Settings window opens from context menu or nav bar."],bgMode:["Mode","Select background type."],isCusTopbarColor:["Set Custom Color","Set custom color for topbar background color."],backgroundColor:["Background Color","Pick solid background color."],custImg:["Custom Image","Use custom image URL for static background."],custUMVImg:["Custom Image","Use custom image URL for playlist background."],imgSrc:["Image Source","Upload image or use URL for custom background."],custImgUrl:["Custom Image URL","Enter image URL for static background."],custImgInput:["Select Custom Image","Select local image for static background."],custImgLocal:["Select Local Image","Select images for static background."],filterBlur:["Blur","Blur level of image (0-200)."],animatedTime:["Time","Time of animated background (1-512)."],animFilterBlur:["Blur","Blur level of animated background (0-200)."],filterBlurCustom:["Blur (Custom)","Blur level for custom page background (0-200)."],filterBlurNormal:["Blur (Default)","Blur level for default page background (0-200)."],filterBlurNpv:["Blur (NPV)","Blur level for NPV page background (0-200)."],filterExtendedBlur:["Extended background Blur","Blur level of extended page background (0-200)."],animFilterBright:["Brightness","Brightness of animated background (0-200)."],animFilterSat:["Saturation","Saturation of animated background (0-200)."],filterBright:["Brightness","Brightness of image (0-200)."],filterSat:["Saturation","Saturation of image (0-200)."],dynColor:["Dynamic Color","Dynamic color themes based on artwork."],tonalColor:["Tonal Color","Tonal color scheme for UI."],custColorEnable:["Custom Color","Enable custom color to override theme color."],custColorPicker:["Select Custom Color",'Choose base theme color. Preview: <a href="https://material-foundation.github.io/material-theme-builder/">Material Theme Builder</a>'],gFontsEnable:["Google Fonts","Enable fonts from Google Fonts."],gFontsUrl:["Google Fonts URL","URL of Google Fonts stylesheet."],fontFamily:["Font Family","Font family for UI when Google Fonts disabled."],grainType:["Grain Type","Type of grain effect overlay."],winCtrlHeight:["Control Height","Height of window control buttons on Windows (0-200)."],winPanelGap:["Panel Gap","Gap between main sections."],homeCardGap:["Home Card Gap","Gap between cards in main view."],newHomeStyle:["New Home Style","Add new styles for home."],flexyHomeStyle:["Flexy cards","Responsive and flexible card layout. Cards adapt to different screen sizes and arrange themselves for optimal viewing on any device."],borderThick:["Thickness","Thickness of interface border (0-10)."],borderColor:["Color","Color of application border."],borderStyle:["Style","Visual style of interface border."],pagesBgStyle:["Style","Background display on pages."],pagesImageStyle:["Image Style","Image on pages. (playlist/album art)"],homeHeaderBg:["Home Header Background","Enable/Disable Home header background."],scrollUmvBg:["Scroll Background","Scroll background main view background."],scaleUmvBg:["Scale Background","Scale background main view background."],rsbViewMode:["View Mode","Normal or compact 'Now Playing' sidebar."],rsbSize:["Compact Sidebar Width","Width of compact 'Now Playing' sidebar (0-512px)."],rsbPos:["Position","Position of compact 'Now Playing' sidebar."],rsbBgBlur:["Blur","Background blur of compact 'Now Playing' view (0-256)."],rsbCustBgEnable:["Custom Background","Enable custom background for Now Playing view."],rsbBgColor:["Color","Background color for 'Now Playing' sidebar."],rsbBgAlpha:["Alpha","Background transparency (alpha) value (0-100)."],rsbBorderAlpha:["Border Alpha","Border transparency (alpha) value (0-100)."],playbarType:["Playbar Type","Default or Compact playbar style."],compactPbHideIcons:["Hide Extra Playbar Icons","Hides extra icons in compact playbar (on hover)."],compactPbBorderRad:["Border Radius","Border Radius of compact playbar in pixels."],normalPbBorderRad:["Border Radius","Border Radius of normal playbar in pixels."],compactPbImgBorderRad:["Art Border Radius","Border Radius of the cover image in compact playbar in pixels."],normalPbImgBorderRad:["Art Border Radius","Border Radius of the cover image in normal playbar in pixels."],compactPbHeight:["Height","Height of compact playbar in pixels."],normalPbHeight:["Height","Height of normal playbar in pixels."],playbarFloat:["Floating","Now playing bar is floating."],pbBackdropBlur:["Backdrop Blur","Blur of normal playbar backdrop (0-256)."],pbBackdropSat:["Backdrop Saturation","Saturation of normal playbar backdrop (0-256)."],pbBackdropBright:["Backdrop Brightness","Brightness of normal playbar backdrop (0-256)."],topBarBackdropBlur:["Backdrop Blur","Blur of normal playbar backdrop (0-256)."],topBarBackdropSat:["Backdrop Saturation","Saturation of normal playbar backdrop (0-256)."],topBarBackdropBright:["Backdrop Brightness","Brightness of normal playbar backdrop (0-256)."],showChangelog:["Show Changelog","Changelog modal after updates."],lucidTour:["Take a Lucid Tour","Guided walkthrough of Lucid theme features."],exportSettings:["Export Settings","Export settings to clipboard as JSON."],importSettings:["Import Settings","Import settings from JSON."],resetSettings:["Reset All Settings","Reset all settings to default values (irreversible)."],pagesScrollType:["Image Source","Now Playing View art or default playlist art for pages."]};function Bt(e=G.getState(),t=G){let o=(e,t,o)=>({render:void 0===o||o,inputOptions:t,label:Et[e][0],tooltip:Et[e][1],key:e.replace(/([A-Z])/g,"-$1").toLowerCase()});return[{name:"General",render:!0,groups:[{render:!0,name:"Behavior",key:"group-behavior",showName:!1,fields:[o("lucidTour",{type:"button",buttonType:"primary",contents:"Start",onClick:()=>{localStorage.removeItem("lucid-guided-tour"),_t(),(()=>{try{localStorage.removeItem(i),vt()}catch(e){console.error("Error opening guide",e),f("Error opening guide")}})()}}),o("floatWin",{type:"checkbox",checked:Ce.getState().isFloating,onChange:e=>{Ce.setState((t=>({...t,isFloating:e})))}}),o("winPos",{type:"select",value:e.position,options:[{label:"Context Menu",value:"context-menu"},{label:"Navigation Bar",value:"nav"}],onChange:e=>{t.setPosition(e)}})]}]},{name:"Background",render:!0,groups:[{render:!0,name:"Mode",key:"group-background-mode",fields:[o("bgMode",{type:"select",value:e.background.mode,options:[{label:"Animated",value:"animated"},{label:"Solid Color",value:"solid"},{label:"Static Image",value:"static"}],onChange:e=>{t.setBackgroundMode(e)}})]},{name:"Background",key:"group-bg-background",render:!0,fields:[o("backgroundColor",{type:"color",value:e.background.options.solid.color.hex,onChange:e=>{t.setSolidBackgroundColor({hex:e})}},"solid"===e.background.mode),o("rsbBgAlpha",{type:"number",value:e.background.options.solid.color.alpha,validator:Ze,onChange:e=>{t.setSolidBackgroundColor({alpha:e})}},"solid"===e.background.mode),o("custImg",{type:"checkbox",checked:e.background.options.static.isCustomImage,onChange:e=>{t.setStaticBackgroundOptions({isCustomImage:e})}},"solid"!==e.background.mode),o("imgSrc",{type:"select",value:e.customImage.type,options:[{label:"Local",value:"local"},{label:"From Url",value:"url"}],onChange:e=>{t.setCustomImageType(e)}},"solid"!==e.background.mode&&e.background.options.static.isCustomImage),o("custImgUrl",{type:"text",value:e.customImage.options.url.data??"Enter Image URL",validator:Ge,onChange:e=>{t.setCustomImageOptions("url",{data:e})}},"solid"!==e.background.mode&&e.background.options.static.isCustomImage&&"url"===e.customImage.type),o("custImgInput",{type:"image",onChange:e=>{e&&((e,t)=>{new Promise(((o,a)=>{let i=()=>{if(!Ye)return;let i=Ye.transaction(["imageStore"],"readwrite").objectStore("imageStore"),n={id:1,data:e},r=i.put(n);r.onsuccess=()=>{console.debug("Image added/updated successfully."),t?.(),o()},r.onerror=e=>{console.error("Error adding/updating image",e),a(e)}};Ye?i():Qe().then(i).catch(a)}))})(e,lt)}},"solid"!==e.background.mode&&e.background.options.static.isCustomImage&&"local"===e.customImage.type),o("animatedTime",{type:"number",step:1,value:e.background.options.animated.time,validator:qe,onChange:e=>{t.setAnimatedBackgroundOptions({time:e})}},"animated"===e.background.mode)]},{render:"solid"!==e.background.mode,name:"Filters",key:"group-bg-filters",fields:[o("filterBlur",{type:"number",value:e.background.options.static.filter.blur,onChange:e=>{t.setStaticBackgroundFilter({blur:e})},step:1,validator:Ke},"static"===e.background.mode),o("filterBright",{type:"number",value:e.background.options.static.filter.brightness,onChange:e=>{t.setStaticBackgroundFilter({brightness:e})},step:1,validator:Ke},"static"===e.background.mode),o("filterSat",{type:"number",value:e.background.options.static.filter.saturate,onChange:e=>{t.setStaticBackgroundFilter({saturate:e})},step:.1,validator:Ke},"static"===e.background.mode),o("animFilterBlur",{type:"number",value:e.background.options.animated.filter.blur,onChange:e=>{t.setAnimatedBackgroundFilter({blur:e})},step:1,validator:Ke},"animated"===e.background.mode),o("animFilterBright",{type:"number",value:e.background.options.animated.filter.brightness,onChange:e=>{t.setAnimatedBackgroundFilter({brightness:e})},step:1,validator:Ke},"animated"===e.background.mode),o("animFilterSat",{type:"number",value:e.background.options.animated.filter.saturate,onChange:e=>{t.setAnimatedBackgroundFilter({saturate:e})},step:1,validator:Ke},"animated"===e.background.mode)]},{render:!0,name:"Color",key:"group-color",fields:[o("dynColor",{type:"checkbox",checked:e.color.isDynamic,onChange:e=>{t.setDynamicColor(e)}}),o("tonalColor",{type:"checkbox",checked:e.color.isTonal,onChange:e=>{t.setTonalColor(e)}}),o("custColorEnable",{type:"checkbox",checked:e.color.isCustom,onChange:e=>{t.setIsCustomColor(e)}},!e.color.isDynamic),o("custColorPicker",{type:"color",value:e.color.customColor.hex,onChange:e=>{t.setCustomColor({hex:e})}},!e.color.isDynamic&&e.color.isCustom)]}]},{name:"Interface",render:!0,groups:[{render:!0,name:"Font",key:"group-font",fields:[o("gFontsEnable",{type:"checkbox",checked:e.font.isGoogleFonts,onChange:e=>{t.setFont({isGoogleFonts:e})}}),o("gFontsUrl",{type:"text",value:e.font.fontUrl||"",validator:Je,onChange:e=>{t.setFont({fontUrl:e})}},e.font.isGoogleFonts),o("fontFamily",{type:"text",value:e.font.fontFamily||"",onChange:e=>{t.setFont({fontFamily:e})}},!e.font.isGoogleFonts)]},{render:!0,key:"group-grain-effect",name:"Grain Effect",fields:[o("grainType",{type:"select",value:e.grains.type,options:[{label:"Normal",value:"default"},{label:"Starry",value:"starry"},{label:"None",value:"none"}],onChange:e=>{t.setGrainsType(e)}})]},{render:!0,key:"group-home-controls",name:"Home",fields:[o("newHomeStyle",{type:"checkbox",checked:e.pages.isNewHome,onChange:e=>{t.setPages({isNewHome:e})}}),o("flexyHomeStyle",{type:"checkbox",checked:e.pages.isFlexyHome,onChange:e=>{t.setPages({isFlexyHome:e})}},e.pages.isNewHome),o("homeCardGap",{type:"number",step:1,value:e.pages.homeCardGap,validator:Ze,onChange:e=>{t.setPages({homeCardGap:e})}})]},{render:!0,key:"group-window-controls",name:"Window",fields:[o("winPanelGap",{type:"number",step:1,value:e.pages.panelGap,validator:Ze,onChange:e=>{t.setPages({panelGap:e})}}),o("winCtrlHeight",{type:"number",step:1,value:e.control.height,validator:Ke,onChange:e=>{t.setControlHeight(e)}},pe())]},{render:!0,key:"group-border",name:"Border",fields:[o("borderThick",{type:"number",step:1,value:e.border.thickness,validator:Xe,onChange:e=>{t.setBorder({thickness:e})}}),o("borderStyle",{type:"select",options:[{label:"None",value:"none"},{label:"Solid",value:"solid"},{label:"Dotted",value:"dotted"},{label:"Dashed",value:"dashed"},{label:"Double",value:"double"},{label:"Groove",value:"groove"},{label:"Ridge",value:"ridge"},{label:"Inset",value:"inset"},{label:"Outset",value:"outset"}],onChange:e=>{t.setBorder({style:e})},value:e.border.style}),o("borderColor",{type:"color",value:e.border.color.hex,onChange:e=>{t.setBorderColor({hex:e})}}),o("rsbBorderAlpha",{type:"number",value:e.border.color.alpha,validator:Ze,onChange:e=>{t.setBorderColor({alpha:e})}})]},{render:!0,key:"group-now-playing-view",name:"Now Playing View",fields:[o("rsbViewMode",{type:"select",value:e.rightSidebar.mode,options:[{label:"Normal",value:"normal"},{label:"Compact",value:"compact"}],onChange:e=>{t.setRightSidebar({mode:e})}}),o("rsbSize",{type:"number",value:e.rightSidebar.size,validator:qe,onChange:e=>{t.setRightSidebar({size:e})}},"compact"===e.rightSidebar.mode),o("rsbPos",{type:"select",value:e.rightSidebar.position,options:[{label:"Top Left",value:"top left"},{label:"Top Right",value:"top right"},{label:"Bottom Left",value:"bottom left"},{label:"Bottom Right",value:"bottom right"}],onChange:e=>{t.setRightSidebar({position:e})}},"compact"===e.rightSidebar.mode),o("rsbBgBlur",{type:"number",value:e.rightSidebar.blur,validator:je,onChange:e=>{t.setRightSidebar({blur:e})}},"compact"===e.rightSidebar.mode),o("rsbCustBgEnable",{type:"checkbox",checked:e.rightSidebar.isCustomBg,onChange:e=>{t.setRightSidebar({isCustomBg:e})}}),o("rsbBgColor",{type:"color",value:e.rightSidebar.color.hex,onChange:e=>{t.setRightSidebarColor({hex:e})}},e.rightSidebar.isCustomBg),o("rsbBgAlpha",{type:"number",value:e.rightSidebar.color.alpha,validator:Ze,onChange:e=>{t.setRightSidebarColor({alpha:e})}},e.rightSidebar.isCustomBg)]}]},{name:"Page Settings",render:!0,groups:[{render:!0,key:"group-page-style",name:"Page Styles",fields:[o("homeHeaderBg",{type:"checkbox",checked:e.pages.hideHomeHeader,onChange:e=>{t.setPages({hideHomeHeader:e})}}),o("pagesBgStyle",{type:"select",value:e.pages.style,onChange:e=>{t.setPageStyle(e)},options:[{label:"Default",value:"normal"},{label:"Card",value:"card"},{label:"Compact",value:"compact"},{label:"Compact Card",value:"compact-card"}]}),o("pagesImageStyle",{type:"select",value:e.pages.imageStyle,onChange:e=>{t.setPageImageStyle(e)},options:[{label:"Default",value:"default"},{label:"As Bg",value:"as-bg"},{label:"Hidden",value:"hidden"}]}),o("pagesScrollType",{type:"select",value:e.pages.umv.type,options:[{value:"normal",label:"Default"},{value:"custom",label:"Custom"},{value:"npv",label:"Now Playing Art"}],onChange:e=>{t.setUMV({type:e})}}),o("custUMVImg",{type:"text",validator:Ge,value:e.pages.umv.options.custom.url??"Enter a Url",onChange:e=>{t.setUMVOption("custom",{url:e})}},"custom"===e.pages.umv.type)]},{key:"group-page-image-filter",name:"Page Background Image Filter",render:!0,fields:[o("filterBlurCustom",{type:"number",validator:Ke,value:e.pages.umv.options.custom.filter?.blur,onChange:e=>{t.setUMVFilter("custom",{blur:e})}},"custom"===e.pages.umv.type),o("filterBlurNormal",{type:"number",validator:Ke,value:e.pages.umv.options.normal.filter?.blur,onChange:e=>{t.setUMVFilter("normal",{blur:e})}},"normal"===e.pages.umv.type),o("filterBlurNpv",{type:"number",validator:Ke,value:e.pages.umv.options.npv.filter?.blur,onChange:e=>{t.setUMVFilter("npv",{blur:e})}},"npv"===e.pages.umv.type),o("filterExtendedBlur",{type:"number",validator:Ke,value:e.pages.umv.options.expanded.filter?.blur,onChange:e=>{t.setUMVFilter("expanded",{blur:e})}})]},{key:"group-page-bg-behavior",name:"Background Behavior",render:!0,fields:[o("scrollUmvBg",{type:"checkbox",checked:e.pages.umv.isScroll,onChange:e=>{t.setUMV({isScroll:e})}}),o("scaleUmvBg",{type:"checkbox",checked:e.pages.umv.isScaling,onChange:e=>{t.setUMV({isScaling:e})}})]}]},{name:"Topbar Settings",render:!0,groups:[{render:!0,showName:!0,name:"Background",key:"topbar-setting-background",fields:[o("isCusTopbarColor",{type:"checkbox",checked:e.topbar.isCustomColor,onChange:e=>{t.setIsCustomTopbarColor(e)}}),o("backgroundColor",{type:"color",value:e.topbar.bgColor.hex,onChange:e=>{t.setTopbarColor({hex:e})}},e.topbar.isCustomColor),o("rsbBgAlpha",{type:"number",value:e.topbar.bgColor.alpha,validator:Ze,onChange:e=>{t.setTopbarColor({alpha:e})}},e.topbar.isCustomColor)]},{render:!0,showName:!0,name:"Backdrop Filters",key:"topbar-setting-filters",fields:[o("topBarBackdropBlur",{type:"number",value:e.topbar.backdropFilter.blur,validator:je,onChange:e=>{t.setTopbarFilter({blur:e})}},e.playbar.isFloating),o("topBarBackdropSat",{type:"number",value:e.topbar.backdropFilter.saturate,validator:je,onChange:e=>{t.setTopbarFilter({saturate:e})}},e.playbar.isFloating),o("topBarBackdropBright",{type:"number",value:e.topbar.backdropFilter.brightness,validator:je,onChange:e=>{t.setTopbarFilter({brightness:e})}},e.playbar.isFloating)]}]},{name:"Playbar Settings",render:!0,groups:[{render:!0,name:"General",key:"group-playbar-general",showName:!1,fields:[o("playbarType",{type:"select",value:e.playbar.type,onChange:e=>{t.setPlaybar({type:e})},options:[{label:"Default",value:"normal"},{label:"Compact",value:"compact"}]}),o("playbarFloat",{type:"checkbox",checked:e.playbar.isFloating,onChange:e=>{t.setPlaybar({isFloating:e})}})]},{render:"compact"===e.playbar.type,name:"Compact Playbar",key:"group-playbar-compact",showName:!0,fields:[o("compactPbHideIcons",{type:"checkbox",checked:e.playbar.hideIcons,onChange:e=>{t.setPlaybar({hideIcons:e})}}),o("compactPbHeight",{type:"number",value:e.playbar.options.compact.height,validator:qe,onChange:e=>{t.setPlaybarOptions("compact",{height:e})}}),o("compactPbBorderRad",{type:"number",value:e.playbar.options.compact.borderRadius,validator:qe,onChange:e=>{t.setPlaybarOptions("compact",{borderRadius:e})}}),o("pbBackdropBlur",{type:"number",value:e.playbar.options.compact.backdropFilter.blur,validator:je,onChange:e=>{t.setPlaybarFilter("compact",{blur:e})}},e.playbar.isFloating),o("pbBackdropSat",{type:"number",value:e.playbar.options.compact.backdropFilter.saturate,validator:je,onChange:e=>{t.setPlaybarFilter("compact",{saturate:e})}},e.playbar.isFloating),o("pbBackdropBright",{type:"number",value:e.playbar.options.compact.backdropFilter.brightness,validator:je,onChange:e=>{t.setPlaybarFilter("compact",{brightness:e})}},e.playbar.isFloating),o("compactPbImgBorderRad",{type:"number",value:e.playbar.options.compact.imageRadius,validator:qe,onChange:e=>{t.setPlaybarOptions("compact",{imageRadius:e})}})]},{render:"normal"===e.playbar.type,name:"Normal Playbar",key:"group-playbar-normal",showName:!0,fields:[o("normalPbHeight",{type:"number",value:e.playbar.options.normal.height,validator:qe,onChange:e=>{t.setPlaybarOptions("normal",{height:e})}}),o("normalPbBorderRad",{type:"number",value:e.playbar.options.normal.borderRadius,validator:qe,onChange:e=>{t.setPlaybarOptions("normal",{borderRadius:e})}}),o("pbBackdropBlur",{type:"number",value:e.playbar.options.normal.backdropFilter.blur,validator:je,onChange:e=>{t.setPlaybarFilter("normal",{blur:e})}},e.playbar.isFloating),o("pbBackdropSat",{type:"number",value:e.playbar.options.normal.backdropFilter.saturate,validator:je,onChange:e=>{t.setPlaybarFilter("normal",{saturate:e})}},e.playbar.isFloating),o("pbBackdropBright",{type:"number",value:e.playbar.options.normal.backdropFilter.brightness,validator:je,onChange:e=>{t.setPlaybarFilter("normal",{brightness:e})}},e.playbar.isFloating),o("normalPbImgBorderRad",{type:"number",value:e.playbar.options.normal.imageRadius,validator:qe,onChange:e=>{t.setPlaybarOptions("normal",{imageRadius:e})}})]}]},{name:"Advanced Settings",render:!0,groups:[{render:!0,name:"App Settings",key:"group-application-settings",showName:!1,fields:[o("showChangelog",{type:"checkbox",checked:e.showChangelog,onChange:e=>{t.setChangelog(e)}}),o("exportSettings",{type:"button",buttonType:"primary",contents:"Copy Settings",onClick:()=>{!async function(e,t="Text copied to clipboard!"){if(navigator.clipboard)try{await navigator.clipboard.writeText(e),console.debug(t),f(t,!1,5e3)}catch(e){console.error("Error copying to clipboard:",e),f(`Error copying to clipboard: ${e instanceof Error?e.message:e}`,!0,5e3)}else console.error("Error copying text (navigator.clipboard not found)"),f("Error copying text (navigator.clipboard not found)",!0,5e3)}(t.exportSettings(),"Settings copied to clipboard!")}}),o("importSettings",{type:"text",value:"",validator:e=>{try{return D(JSON.parse(e))?{isValid:!0}:{isValid:!1,message:"Not a valid lucid settings."}}catch{return{isValid:!1,message:"Not a valid lucid settings."}}},onChange:e=>{t.importSettings(e)}}),o("resetSettings",{type:"button",buttonType:"danger",contents:"Reset",onClick:()=>{confirm("Are you sure you want to reset all settings to default values? This action cannot be undone.")&&(t.resetState(),window.location.reload())}})]}]}]}function It(e=G.getState().rightSidebar){var t;e.position?document.body.setAttribute("npv-position",e.position):document.body.removeAttribute("npv-position"),e.mode?document.body.setAttribute("npv-mode",e.mode):document.body.removeAttribute("npv-mode"),document.body.style.setProperty("--npv-blur",`${e.blur}px`),e.isCustomBg?document.body.style.setProperty("--npv-bg-color",`${e.color.hex}${be(e.color.alpha)}`):document.body.style.removeProperty("--npv-bg-color"),t=e.size,document.body.style.setProperty("--npv-size",`${t}px`)}var Lt=null;function $t(e=G.getState().grains){let t=e.type;Lt!==t&&(Lt&&document.body.classList.remove(`grain-${Lt}`),t?(document.body.setAttribute("grain-type",t),document.body.classList.add(`grain-${t}`)):document.body.removeAttribute("grain-type"),Lt=t)}var Ft=class extends HTMLElement{constructor(e){super(),this._data=null,this.hasUpdate=!1,this._currentVersion=a,e&&(this._data=e,this.hasUpdate=this.checkForUpdate())}connectedCallback(){b("lucid-changelog").textContent=".changelog-entry,.update-available-header {  padding: 1rem 1rem;  background-color: rgba(var(--clr-on-secondary-rgb), 0.5);  color: var(--clr-secondary);  margin-bottom: 0.5rem;  border-radius: 0.5rem;}.update-available-header {  text-align: center;  font-size: 1.8em;  color: var(--clr-primary);}.changelog-entry > p {  margin-bottom: 0.5rem;}.changes-wrapper {  display: flex;  flex-wrap: wrap;  gap: 0.5rem;}.changelog-entry,.update-available-header,.change-card {  border: var(--border-thickness, 1px) var(--border-style, solid)    var(--border-color, var(--clr-surface-5, #1c1b1e));}.change-card {  flex-grow: 1;  padding: 10px;  border-radius: 0.75rem;  min-width: 10em;}.change-card:nth-child(2n) {  background-color: rgba(var(--clr-on-primary-rgb), 0.7);  color: var(--clr-primary);}.change-card:nth-child(2n + 1) {  background-color: rgba(var(--clr-on-secondary-rgb), 0.7);  color: var(--clr-secondary);}.change-card:nth-child(2n + 3) {  background-color: rgba(var(--clr-on-tertiary-rgb), 0.7);  color: var(--clr-tertiary);}.change-card li {  list-style: disc;  margin-left: 2rem;}.change-card li:marker {  right: 4px;}",this.render()}checkForUpdate(){if(this._data&&this._data.length>0&&this._currentVersion){return function(e,t){let o=e.split(".").map(Number),a=t.split(".").map(Number),i=Math.max(o.length,a.length);for(let e=0;e<i;e++){let t=o[e]||0,i=a[e]||0;if(t>i)return 1;if(t<i)return-1}return 0}(this._data[0].version,this._currentVersion)>0}return!1}render(){if(this.innerHTML="",!this._data)return this.innerHTML="<p>Error loading changelog data.</p>",void console.error("Invalid changelog data format.");if(this._data.length<1)return this.innerHTML="<p>No changelog entries available.</p>",void console.warn("No elements present to show changelog.");let e=this._data.map((e=>{let t="";for(let o in e.changes)if(Object.prototype.hasOwnProperty.call(e.changes,o)){let a=e.changes[o];if(a&&a.length>0){t+=`\n                    <div class="change-card">\n                      <h3 class='encore-text encore-text-small-bold'>${o}</h3>\n                      <ul>${a.map((e=>`<li>${e}</li>`)).join("")}</ul>\n                    </div>\n                  `}}let o=e.desc?`<p>${e.desc}</p>`:"";return`\n              <div class="changelog-entry">\n                <h2>${e.version} - ${e.date}</h2>\n                ${o}\n                <div class="changes-wrapper">\n                  ${t}\n                </div>\n              </div>\n            `})).join(""),t="";this.hasUpdate&&(t='<h1 class="update-available-header">Update Available</h1>');let o=document.createElement("div");o.innerHTML=`\n        ${t}\n        <div class="changelog-entries-container">${e}</div>`,this.appendChild(o)}updateData(e){this._data=e,this.hasUpdate=this.checkForUpdate(),this.render()}};async function Pt(e=document.body){if(!G.getState().showChangelog)return;let t=await async function(){try{let e=await ee(l,c,21600);return JSON.parse(e)}catch(e){return console.error("Error fetching changelog.",e),[]}}();if("object"==typeof t&&t.length<1)return void console.error("Changelog data not found.");let o=new Ie;o.setHeader("Lucid Changelog");let i=new Ft(t);localStorage.getItem(s)!==a||i.hasUpdate?(o.setContent(i),e.appendChild(o),o.open(),localStorage.setItem(s,a)):console.debug("Changelog already shown for this version.")}customElements.define("changelog-component",Ft);function Tt(e=G.getState()){let t=e.border,o=b("lucid-border");o.textContent=":root{",o.textContent+=`--border-color:${t.color.hex}${be(t.color.alpha)};`,t.style&&(o.textContent+=`--border-style:${t.style};`),t.thickness&&(o.textContent+=`--border-thickness:${t.thickness}px;`),o.textContent+="}"}G.subscribe(Tt,"border");var Mt="lucid-umv-wrapper",Rt="umv",Ht="umv-img",At="lucid-umv",Ot="lucid-scroll",Nt=e("div",{className:Mt}),Ut=e("div",{className:Rt}),Vt=e("div",{className:Ht});function Dt(){let e=(e=G.getState())=>{!function(e=G.getState().pages.umv){Ut.style.transform=`translate3d(0px,${e.isScroll?"var(--scroll-top)":"0px"},0px) scale(${e.isScaling?"calc(1 + var(--scroll-coefficient))":"1"})`,Ut.style.filter="blur(calc(16px * var(--scroll-coefficient)))";for(let t in e.options){let o=e.options[t];Nt.style.setProperty(`--${t}-filter`,et(o.filter??{})),"custom"===t&&Vt.style.setProperty("--custom-img-url",`url(${o?.url??""})`),Ut.classList.toggle("custom","custom"===e.type),Ut.classList.toggle("npv","npv"===e.type)}}(e.pages.umv)};G.subscribe(e,"pages.umv"),e()}function zt(){fe([p],(([e])=>{if(!e)return void f("Lucid: No scroll element found.",!0);if(typeof Ut>"u"||!Ut)return void f("Lucid: imgWrapperElem is not defined.",!0);let t=b(Ot);if(!t)return void f("Lucid: Failed to load scroll indicator style.",!0);t.textContent="\n@property --scroll-top {\n  syntax: '<length>';\n  inherits: false;\n  initial-value: 0;\n}\n@property --scroll-coefficient {\n  syntax: '<number>';\n  inherits: false;\n  initial-value: 0;\n}";let o=!0;e.addEventListener("scrollend",(()=>{o=!0})),e.addEventListener("scroll",(()=>{if(o){let e=document.querySelectorAll(".Root__main-view .marketplace-header,.mjZrvVI3CxfHJXu7y0Lg,.fIvMht6B9HdROywMNJZ4, .main-home-filterChipsSection, .Root__main-view .main-home-filterChipsSection, .Root__main-view .main-trackList-trackListHeaderStuck.main-trackList-trackListHeader, .Root__main-view .main-topBar-background, .Root__main-view .search-searchCategory-SearchCategory");for(let t of e)t.style.willChange="transform",t.offsetHeight;o=!1}})),e.addEventListener("scroll",(e=>{let t=e.target;if(!(t instanceof HTMLElement))return;let o=t.scrollTop;o>window.innerHeight||(Ut.style.setProperty("--scroll-top",`-${Math.round(o)}px`),Ut.style.setProperty("--scroll-coefficient",`${Math.min(1,Math.max(0,o/window.innerHeight))}`))}))})),b(At).innerHTML=`\n.under-main-view { display: none; }\n.main-entityHeader-container.main-entityHeader-withBackgroundImage{height: calc(100cqh - var(--umv-offset) - 1rem);}\nbody[data-path="/"] .lucid-umv-wrapper {display: none}\n.main-entityHeader-container{ height: 40cqh; }\n.main-entityHeader-backgroundColor,.main-actionBarBackground-background { background: none !important;}\n.playlist-playlist-playlistContent,.EmeHQXR87mUskYK6xEde { background-color: rgba(var(--clr-surface-1-rgb),.5) !important; }\n.${Mt} .${Rt} {height: 50cqh;width: 100%;position: absolute;z-index: -1;inset: 0}\n.${Mt} .${Rt}.expanded,\nbody[npb-is-floating] .main-entityHeader-container.main-entityHeader-withBackgroundImage{height: calc(100cqh - var(--umv-offset))}\n.${Ht} {height: 100%;width: 100%;object-fit: contain;border: none;box-shadow: none;background-image: none;transition: background-image .3s ease-in-out;background-position: center center;background-repeat: no-repeat;background-size: cover;-webkit-mask-image: linear-gradient(rgb(0, 0, 0) 35cqh, rgba(0, 0, 0, 0) 100%);mask-image: linear-gradient(rgb(0, 0, 0) 35cqh, rgba(0, 0, 0, 0) 100%)}\n.normal .${Ht}{background-image: var(--page-img-url);filter: var(--normal-filter)}\n.npv .${Ht}{background-image: var(--npv-img-url);filter: var(--npv-filter)}\n.custom .${Ht}{background-image: var(--custom-img-url);filter: var(--custom-filter)}\n.expanded .${Ht}{background-image: var(--umv-img-url);filter: var(--expanded-filter);-webkit-mask-image: none;mask-image: none}\n`,function(){let e=document.querySelector(".under-main-view")?.parentElement;e?e.prepend(Nt):document.querySelector(".main-view-container")?.prepend(Nt)}(),Ut.appendChild(Vt),Nt.appendChild(Ut),Dt(),function(){let e=async(e=Spicetify?.Platform?.History?.location)=>{if(e?.pathname){let t=await J(e.pathname);Ut.classList.toggle("normal",!!t),Vt.style.setProperty("--page-img-url",`url("${t}")`)}};e(),Spicetify.Platform?.History?.listen((async t=>{await e(t)}))}(),function(){let e=document.querySelector(u);if(!e)return void console.warn(`Element "${u}" not found. UMV visibility observation will not work.`);new MutationObserver((()=>{let t=e.querySelector(h);if(Ut.classList.remove("expanded"),t){let e=function(e){let t=e.match(/url\(["']?(.*?)["']?\)/);return t?t[1]:null}(t.style.backgroundImage);e&&(Ut.classList.add("expanded"),Vt.style.setProperty("--umv-img-url",`url(${e})`))}else Vt.style.removeProperty("--umv-img-url")})).observe(e,{childList:!0,subtree:!0})}()}function Gt(e=G.getState().topbar){b("lucid-topbar").textContent=`\n:root,\n.marketplace-header,\n.main-home-filterChipsSection,\n.main-trackList-trackListHeaderStuck.main-trackList-trackListHeader,\n.main-topBar-background,\n.search-searchCategory-SearchCategory{\n    --top-bar-blur: ${e.backdropFilter.blur??32}px;\n    --top-bar-saturate: ${e.backdropFilter.saturate??150}%;\n    --top-bar-brightness: ${e.backdropFilter.brightness??80}%;\n    ${e.isCustomColor?`--top-bar-color: ${e.bgColor.hex?e.bgColor.hex+be(e.bgColor.alpha):`rgba(var(--clr-surface-1-rgb), ${e.bgColor.alpha}%)`}`:""} }`}G.subscribe((e=>{Gt(e.topbar)}),"topbar");function Wt(){document.querySelectorAll(".main-nowPlayingWidget-coverArt .cover-art").forEach((e=>{e.style.width="",e.style.height="",e.removeAttribute("width"),e.removeAttribute("height")}))}function qt(){document.querySelectorAll(".main-coverSlotCollapsed-container.main-coverSlotCollapsed-navAltContainer").forEach((e=>{e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center"})),document.querySelectorAll('.main-coverSlotCollapsed-container.main-coverSlotCollapsed-navAltContainer div[draggable="true"]').forEach((e=>{e.style.width="calc(var(--npb-height, 56px) - 8px)",e.style.height="calc(var(--npb-height, 56px) - 8px)"})),document.querySelectorAll(".main-nowPlayingWidget-coverArt").forEach((e=>{e.style.width="calc(var(--npb-height, 56px) - 8px)",e.style.height="calc(var(--npb-height, 56px) - 8px)"})),document.querySelectorAll(".main-nowPlayingWidget-coverArt .cover-art").forEach((e=>{e.style.width="calc(var(--npb-height, 56px) - 8px)",e.style.height="calc(var(--npb-height, 56px) - 8px)"}))}console.time("Main fn start"),(()=>{try{window.lucid={config:()=>G.getState(),reset:()=>{G.resetState()},store:G,version:localStorage.getItem(s)??"2.1.3",settings:{openSettings:Ct,closeSettings:_t,settingModal:kt}},fe([".Root__now-playing-bar",".Root__globalNav"],(([e,t])=>{document.body.style.setProperty("--umv-offset",`${(e?.clientHeight||80)+(t?.clientHeight||64)}px`)})),zt(),st(),rt(),lt(),G.subscribe((e=>{rt(e)}),"background"),G.subscribe((()=>{lt()}),"customImage.type"),Y.subscribe((()=>{lt()})),Tt(),Gt(),w(),W(),G.subscribe((e=>{W(e.font)})),$t(),G.subscribe((e=>{$t(e.grains)}),"grains"),K(),de(Spicetify?.Platform?.History?.location?.pathname||"/"),Spicetify?.Platform?.History?.listen((e=>{!e||!e.pathname||de(e.pathname)})),pe()&&(ge(),window.addEventListener("resize",me),document.addEventListener("fullscreenchange",(()=>{document.body.classList.toggle("hide-transparent-controls",null!==document.fullscreenElement)})),G.subscribe((e=>ge(e.control.height)),"control")),window.addEventListener("resize",Se),ye(),ke(we||(ve?.clientWidth||0)<900),G.subscribe((e=>{ke((we=e.playbar.hideIcons)||(ve?.clientWidth||0)<900),ye(e.playbar)}),"playbar"),Se(),It(),G.subscribe((e=>{It(e.rightSidebar)}),"rightSidebar"),se(),G.subscribe((e=>{se(e.color)}),"color"),xt(),Pt(),vt(),fe([".Root"],(([e])=>{e&&new MutationObserver((()=>{let t=e.querySelector(".FP_XXx0FMQPJEu3WzfpM");t&&new MutationObserver((()=>{let e=t.style.backgroundColor.match(/rgb\(\s*((?:\d{1,3}\s*,\s*){2}\d{1,3})\s*\)/)?.[1];!e||!t.parentElement||t.parentElement.style.setProperty("--accent-color",e)})).observe(t,{attributes:!0})})).observe(e,{childList:!0})}));let e=document.querySelector(".global-nav, .Root__globalNav");document.body.classList.toggle("global-nav",!!e),document.body.classList.toggle("control-nav",!e)}catch(e){console.error("Unexpected Error: ",e),f("Lucid: Unexpected error. please report it to dev")}})(),console.timeEnd("Main fn start"),Wt(),qt(),Spicetify.Player.addEventListener("songchange",(()=>{Wt(),qt()}));new MutationObserver((()=>{Wt(),qt()})).observe(document.body,{childList:!0,subtree:!0})})()})();